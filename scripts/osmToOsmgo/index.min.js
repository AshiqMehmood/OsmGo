"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}Object.defineProperty(exports,"__esModule",{value:!0});var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var util=createCommonjsModule((function(e,t){const r=function(e,t){const r=t.exec(e);return!(null==r)};t.isExist=function(e){return void 0!==e},t.isEmptyObject=function(e){return 0===Object.keys(e).length},t.merge=function(e,t,r){if(t){const n=Object.keys(t),o=n.length;for(let a=0;a<o;a++)e[n[a]]="strict"===r?[t[n[a]]]:t[n[a]]}},t.getValue=function(e){return t.isExist(e)?e:""},t.buildOptions=function(e,t,r){var n={};if(!e)return t;for(let o=0;o<r.length;o++)void 0!==e[r[o]]?n[r[o]]=e[r[o]]:n[r[o]]=t[r[o]];return n},t.doesMatch=r,t.doesNotMatch=function(e,t){return!r(e,t)},t.getAllMatches=function(e,t){const r=[];let n=t.exec(e);for(;n;){const o=[],a=n.length;for(let e=0;e<a;e++)o.push(n[e]);r.push(o),n=t.exec(e)}return r}})),util_1=util.isExist,util_2=util.isEmptyObject,util_3=util.merge,util_4=util.getValue,util_5=util.buildOptions,util_6=util.doesMatch,util_7=util.doesNotMatch,util_8=util.getAllMatches;const convertToJson=function(e,t){const r={};if(!(e.child&&!util.isEmptyObject(e.child)||e.attrsMap&&!util.isEmptyObject(e.attrsMap)))return util.isExist(e.val)?e.val:"";util.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==t.cdataPositionChar)&&("strict"===t.arrayMode?r[t.textNodeName]=[e.val]:r[t.textNodeName]=e.val),util.merge(r,e.attrsMap,t.arrayMode);const n=Object.keys(e.child);for(let i=0;i<n.length;i++){var o=n[i];if(e.child[o]&&e.child[o].length>1)for(var a in r[o]=[],e.child[o])r[o].push(convertToJson(e.child[o][a],t));else if(!0===t.arrayMode){const n=convertToJson(e.child[o][0],t);r[o]="object"==typeof n?[n]:n}else"strict"===t.arrayMode?r[o]=[convertToJson(e.child[o][0],t)]:r[o]=convertToJson(e.child[o][0],t)}return r};var convertToJson_1=convertToJson,node2json={convertToJson:convertToJson_1},xmlNode=function(e,t,r){this.tagname=e,this.parent=t,this.child={},this.attrsMap={},this.val=r,this.addChild=function(e){Array.isArray(this.child[e.tagname])?this.child[e.tagname].push(e):this.child[e.tagname]=[e]}};const buildOptions=util.buildOptions,TagType={OPENING:1,CLOSING:2,SELF:3,CDATA:4};let regx="<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|(([\\w:\\-._]*:)?([\\w:\\-._]+))([^>]*)>|((\\/)(([\\w:\\-._]*:)?([\\w:\\-._]+))\\s*>))([^<]*)";!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const defaultOptions={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",localeRange:"",tagValueProcessor:function(e,t){return e},attrValueProcessor:function(e,t){return e},stopNodes:[]};var defaultOptions_1=defaultOptions;const props=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","localeRange","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","stopNodes"];var props_1=props;const getTraversalObj=function(e,t){t=buildOptions(t,defaultOptions,props),e=e.replace(/<!--[\s\S]*?-->/g,"");const r=new xmlNode("!xml");let n=r;regx=regx.replace(/\[\\w/g,"["+t.localeRange+"\\w");const o=new RegExp(regx,"g");let a=o.exec(e),i=o.exec(e);for(;a;){const r=checkForTagType(a);if(r===TagType.CLOSING)n.parent&&a[14]&&(n.parent.val=util.getValue(n.parent.val)+""+processTagValue(a,t,n.parent.tagname)),t.stopNodes.length&&t.stopNodes.includes(n.tagname)&&(n.child=[],null==n.attrsMap&&(n.attrsMap={}),n.val=e.substr(n.startIndex+1,a.index-n.startIndex-1)),n=n.parent;else if(r===TagType.CDATA)if(t.cdataTagName){const e=new xmlNode(t.cdataTagName,n,a[3]);e.attrsMap=buildAttributesMap(a[8],t),n.addChild(e),n.val=util.getValue(n.val)+t.cdataPositionChar,a[14]&&(n.val+=processTagValue(a,t))}else n.val=(n.val||"")+(a[3]||"")+processTagValue(a,t);else if(r===TagType.SELF){n&&a[14]&&(n.val=util.getValue(n.val)+""+processTagValue(a,t));const e=new xmlNode(t.ignoreNameSpace?a[7]:a[5],n,"");a[8]&&a[8].length>0&&(a[8]=a[8].substr(0,a[8].length-1)),e.attrsMap=buildAttributesMap(a[8],t),n.addChild(e)}else{const e=new xmlNode(t.ignoreNameSpace?a[7]:a[5],n,processTagValue(a,t));t.stopNodes.length&&t.stopNodes.includes(e.tagname)&&(e.startIndex=a.index+a[1].length),e.attrsMap=buildAttributesMap(a[8],t),n.addChild(e),n=e}a=i,i=o.exec(e)}return r};function processTagValue(e,t,r){const n=e[7]||r;let o=e[14];return o&&(t.trimValues&&(o=o.trim()),o=parseValue(o=t.tagValueProcessor(o,n),t.parseNodeValue,t.parseTrueNumberOnly)),o}function checkForTagType(e){return"]]>"===e[4]?TagType.CDATA:"/"===e[10]?TagType.CLOSING:void 0!==e[8]&&"/"===e[8].substr(e[8].length-1)?TagType.SELF:TagType.OPENING}function resolveNameSpace(e,t){if(t.ignoreNameSpace){const t=e.split(":"),r="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=r+t[1])}return e}function parseValue(e,t,r){if(t&&"string"==typeof e){let t;return""===e.trim()||isNaN(e)?t="true"===e||"false"!==e&&e:(t=-1!==e.indexOf("0x")?Number.parseInt(e,16):-1!==e.indexOf(".")?Number.parseFloat(e):Number.parseInt(e,10),r&&(t=String(t)===e?t:e)),t}return util.isExist(e)?e:""}const attrsRegx=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function buildAttributesMap(e,t){if(!t.ignoreAttributes&&"string"==typeof e){e=e.replace(/\r?\n/g," ");const r=util.getAllMatches(e,attrsRegx),n=r.length,o={};for(let e=0;e<n;e++){const n=resolveNameSpace(r[e][1],t);n.length&&(void 0!==r[e][4]?(t.trimValues&&(r[e][4]=r[e][4].trim()),r[e][4]=t.attrValueProcessor(r[e][4],n),o[t.attributeNamePrefix+n]=parseValue(r[e][4],t.parseAttributeValue,t.parseTrueNumberOnly)):t.allowBooleanAttributes&&(o[t.attributeNamePrefix+n]=!0))}if(!Object.keys(o).length)return;if(t.attrNodeName){const e={};return e[t.attrNodeName]=o,e}return o}}var getTraversalObj_1=getTraversalObj,xmlstr2xmlnode={defaultOptions:defaultOptions_1,props:props_1,getTraversalObj:getTraversalObj_1};const defaultOptions$1={allowBooleanAttributes:!1,localeRange:"a-zA-Z"},props$1=["allowBooleanAttributes","localeRange"];var validate=function(e,t){t=util.buildOptions(t,defaultOptions$1,props$1);const r=[];let n=!1;"\ufeff"===e[0]&&(e=e.substr(1));const o=new RegExp("^[_w][\\w\\-.:]*$".replace("_w","_"+t.localeRange)),a=new RegExp("^([w]|_)[\\w.\\-_:]*".replace("([w","(["+t.localeRange));for(let i=0;i<e.length;i++){if("<"!==e[i]){if(" "===e[i]||"\t"===e[i]||"\n"===e[i]||"\r"===e[i])continue;return{err:{code:"InvalidChar",msg:"char "+e[i]+" is not expected ."}}}if("?"===e[++i]){if((i=readPI(e,++i)).err)return i}else{if("!"===e[i]){i=readCommentAndCDATA(e,i);continue}{let s=!1;"/"===e[i]&&(s=!0,i++);let l="";for(;i<e.length&&">"!==e[i]&&" "!==e[i]&&"\t"!==e[i]&&"\n"!==e[i]&&"\r"!==e[i];i++)l+=e[i];if("/"===(l=l.trim())[l.length-1]){l=l.substring(0,l.length-1);continue}if(!validateTagName(l,a))return{err:{code:"InvalidTag",msg:"Tag "+l+" is an invalid name."}};const u=readAttributeStr(e,i);if(!1===u)return{err:{code:"InvalidAttr",msg:'Attributes for "'+l+'" have open quote.'}};let c=u.value;if(i=u.index,"/"===c[c.length-1]){const e=validateAttributeString(c=c.substring(0,c.length-1),t,o);if(!0!==e)return e;n=!0}else if(s){if(!u.tagClosed)return{err:{code:"InvalidTag",msg:'closing tag "'+l+"\" don't have proper closing."}};if(c.trim().length>0)return{err:{code:"InvalidTag",msg:'closing tag "'+l+"\" can't have attributes or invalid starting."}};{const e=r.pop();if(l!==e)return{err:{code:"InvalidTag",msg:"closing tag "+e+" is expected inplace of "+l+"."}}}}else{const e=validateAttributeString(c,t,o);if(!0!==e)return e;r.push(l),n=!0}for(i++;i<e.length;i++)if("<"===e[i]){if("!"===e[i+1]){i=readCommentAndCDATA(e,++i);continue}break}"<"===e[i]&&i--}}}return n?!(r.length>0)||{err:{code:"InvalidXml",msg:"Invalid "+JSON.stringify(r,null,4).replace(/\r?\n/g,"")+" found."}}:{err:{code:"InvalidXml",msg:"Start tag expected."}}};function readPI(e,t){for(var r=t;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{var n=e.substr(r,t-r);if(t>5&&"xml"===n)return{err:{code:"InvalidXml",msg:"XML declaration allowed only at the start of the document."}};if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function readCommentAndCDATA(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let r=1;for(t+=8;t<e.length;t++)if("<"===e[t])r++;else if(">"===e[t]&&0===--r)break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}var doubleQuote='"',singleQuote="'";function readAttributeStr(e,t){let r="",n="",o=!1;for(;t<e.length;t++){if(e[t]===doubleQuote||e[t]===singleQuote)if(""===n)n=e[t];else{if(n!==e[t])continue;n=""}else if(">"===e[t]&&""===n){o=!0;break}r+=e[t]}return""===n&&{value:r,index:t,tagClosed:o}}const validAttrStrRegxp=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function validateAttributeString(e,t,r){const n=util.getAllMatches(e,validAttrStrRegxp),o={};for(let e=0;e<n.length;e++){if(0===n[e][1].length)return{err:{code:"InvalidAttr",msg:"attribute "+n[e][2]+" has no space in starting."}};if(void 0===n[e][3]&&!t.allowBooleanAttributes)return{err:{code:"InvalidAttr",msg:"boolean attribute "+n[e][2]+" is not allowed."}};const a=n[e][2];if(!validateAttrName(a,r))return{err:{code:"InvalidAttr",msg:"attribute "+a+" is an invalid name."}};if(o.hasOwnProperty(a))return{err:{code:"InvalidAttr",msg:"attribute "+a+" is repeated."}};o[a]=1}return!0}function validateAttrName(e,t){return util.doesMatch(e,t)}function validateTagName(e,t){return!util.doesNotMatch(e,t)}var validator={validate:validate};const char=function(e){return String.fromCharCode(e)},chars={nilChar:char(176),missingChar:char(201),nilPremitive:char(175),missingPremitive:char(200),emptyChar:char(178),emptyValue:char(177),boundryChar:char(179),objStart:char(198),arrStart:char(204),arrayEnd:char(185)},charsArr=[chars.nilChar,chars.nilPremitive,chars.missingChar,chars.missingPremitive,chars.boundryChar,chars.emptyChar,chars.emptyValue,chars.arrayEnd,chars.objStart,chars.arrStart],_e=function(e,t,r){if("string"==typeof t)return e&&e[0]&&void 0!==e[0].val?getValue(e[0].val):getValue(e);{const n=hasData(e);if(!0===n){let n="";if(Array.isArray(t)){n+=chars.arrStart;const o=t[0],a=e.length;if("string"==typeof o)for(let t=0;t<a;t++){const r=getValue(e[t].val);n=processValue(n,r)}else for(let t=0;t<a;t++){const a=_e(e[t],o,r);n=processValue(n,a)}n+=chars.arrayEnd}else{n+=chars.objStart;const o=Object.keys(t);Array.isArray(e)&&(e=e[0]);for(let a in o){const i=o[a];let s;s=!r.ignoreAttributes&&e.attrsMap&&e.attrsMap[i]?_e(e.attrsMap[i],t[i],r):i===r.textNodeName?_e(e.val,t[i],r):_e(e.child[i],t[i],r),n=processValue(n,s)}}return n}return n}},getValue=function(e){switch(e){case void 0:return chars.missingPremitive;case null:return chars.nilPremitive;case"":return chars.emptyValue;default:return e}},processValue=function(e,t){return isAppChar(t[0])||isAppChar(e[e.length-1])||(e+=chars.boundryChar),e+t},isAppChar=function(e){return-1!==charsArr.indexOf(e)};function hasData(e){return void 0===e?chars.missingChar:null===e?chars.nilChar:!(e.child&&0===Object.keys(e.child).length&&(!e.attrsMap||0===Object.keys(e.attrsMap).length))||chars.emptyChar}const buildOptions$1=util.buildOptions,convert2nimn=function(e,t,r){return r=buildOptions$1(r,xmlstr2xmlnode.defaultOptions,xmlstr2xmlnode.props),_e(e,t,r)};var convert2nimn_1=convert2nimn,nimndata={convert2nimn:convert2nimn_1};const buildOptions$2=util.buildOptions,convertToJsonString=function(e,t){return(t=buildOptions$2(t,xmlstr2xmlnode.defaultOptions,xmlstr2xmlnode.props)).indentBy=t.indentBy||"",_cToJsonStr(e,t)},_cToJsonStr=function(e,t,r){let n="{";const o=Object.keys(e.child);for(let r=0;r<o.length;r++){var a=o[r];if(e.child[a]&&e.child[a].length>1){for(var i in n+='"'+a+'" : [ ',e.child[a])n+=_cToJsonStr(e.child[a][i],t)+" , ";n=n.substr(0,n.length-1)+" ] "}else n+='"'+a+'" : '+_cToJsonStr(e.child[a][0],t)+" ,"}return util.merge(n,e.attrsMap),util.isEmptyObject(n)?util.isExist(e.val)?e.val:"":(util.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==t.cdataPositionChar)&&(n+='"'+t.textNodeName+'" : '+stringval(e.val)),","===n[n.length-1]&&(n=n.substr(0,n.length-2)),n+"}")};function stringval(e){return!0!==e&&!1!==e&&isNaN(e)?'"'+e+'"':e}var convertToJsonString_1=convertToJsonString,node2json_str={convertToJsonString:convertToJsonString_1};const buildOptions$3=util.buildOptions,defaultOptions$2={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(e){return e},attrValueProcessor:function(e){return e}},props$2=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor"];function Parser(e){this.options=buildOptions$3(e,defaultOptions$2,props$2),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=isAttribute),this.options.cdataTagName?this.isCDATA=isCDATA:this.isCDATA=function(){return!1},this.replaceCDATAstr=replaceCDATAstr,this.replaceCDATAarr=replaceCDATAarr,this.options.format?(this.indentate=indentate,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=buildEmptyTextNode,this.buildObjNode=buildEmptyObjNode):(this.buildTextNode=buildTextValNode,this.buildObjNode=buildObjectNode),this.buildTextValNode=buildTextValNode,this.buildObjectNode=buildObjectNode}function replaceCDATAstr(e,t){return e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e?e+"<![CDATA["+t+"]]"+this.tagEndChar:e.replace(this.options.cdataPositionChar,"<![CDATA["+t+"]]"+this.tagEndChar)}function replaceCDATAarr(e,t){if(e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e)return e+"<![CDATA["+t.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(let r in t)e=e.replace(this.options.cdataPositionChar,"<![CDATA["+t[r]+"]]>");return e+this.newLine}function buildObjectNode(e,t,r,n){return r&&!e.includes("<")?this.indentate(n)+"<"+t+r+">"+e+"</"+t+this.tagEndChar:this.indentate(n)+"<"+t+r+this.tagEndChar+e+this.indentate(n)+"</"+t+this.tagEndChar}function buildEmptyObjNode(e,t,r,n){return""!==e?this.buildObjectNode(e,t,r,n):this.indentate(n)+"<"+t+r+"/"+this.tagEndChar}function buildTextValNode(e,t,r,n){return this.indentate(n)+"<"+t+r+">"+this.options.tagValueProcessor(e)+"</"+t+this.tagEndChar}function buildEmptyTextNode(e,t,r,n){return""!==e?this.buildTextValNode(e,t,r,n):this.indentate(n)+"<"+t+r+"/"+this.tagEndChar}function indentate(e){return this.options.indentBy.repeat(e)}function isAttribute(e){return!!e.startsWith(this.options.attributeNamePrefix)&&e.substr(this.attrPrefixLen)}function isCDATA(e){return e===this.options.cdataTagName}Parser.prototype.parse=function(e){return this.j2x(e,0).val},Parser.prototype.j2x=function(e,t){let r="",n="";const o=Object.keys(e),a=o.length;for(let i=0;i<a;i++){const a=o[i];if(void 0===e[a]);else if(null===e[a])n+=this.indentate(t)+"<"+a+"/"+this.tagEndChar;else if(e[a]instanceof Date)n+=this.buildTextNode(e[a],a,"",t);else if("object"!=typeof e[a]){const o=this.isAttribute(a);o?r+=" "+o+'="'+this.options.attrValueProcessor(""+e[a])+'"':this.isCDATA(a)?e[this.options.textNodeName]?n+=this.replaceCDATAstr(e[this.options.textNodeName],e[a]):n+=this.replaceCDATAstr("",e[a]):a===this.options.textNodeName?e[this.options.cdataTagName]||(n+=this.options.tagValueProcessor(""+e[a])):n+=this.buildTextNode(e[a],a,"",t)}else if(Array.isArray(e[a]))if(this.isCDATA(a))n+=this.indentate(t),e[this.options.textNodeName]?n+=this.replaceCDATAarr(e[this.options.textNodeName],e[a]):n+=this.replaceCDATAarr("",e[a]);else{const r=e[a].length;for(let o=0;o<r;o++){const r=e[a][o];if(void 0===r);else if(null===r)n+=this.indentate(t)+"<"+a+"/"+this.tagEndChar;else if("object"==typeof r){const e=this.j2x(r,t+1);n+=this.buildObjNode(e.val,a,e.attrStr,t)}else n+=this.buildTextNode(r,a,"",t)}}else if(this.options.attrNodeName&&a===this.options.attrNodeName){const t=Object.keys(e[a]),n=t.length;for(let o=0;o<n;o++)r+=" "+t[o]+'="'+this.options.attrValueProcessor(""+e[a][t[o]])+'"'}else{const r=this.j2x(e[a],t+1);n+=this.buildObjNode(r.val,a,r.attrStr,t)}}return{attrStr:r,val:n}};var json2xml=Parser,parser=createCommonjsModule((function(e,t){const r=xmlstr2xmlnode,n=util.buildOptions;t.parse=function(e,t,o){if(o){!0===o&&(o={});const t=validator.validate(e,o);if(!0!==t)throw Error(t.err.msg)}return t=n(t,r.defaultOptions,r.props),node2json.convertToJson(xmlstr2xmlnode.getTraversalObj(e,t),t)},t.convertTonimn=nimndata.convert2nimn,t.getTraversalObj=xmlstr2xmlnode.getTraversalObj,t.convertToJson=node2json.convertToJson,t.convertToJsonString=node2json_str.convertToJsonString,t.validate=validator.validate,t.j2xParser=json2xml,t.parseToNimn=function(e,r,n){return t.convertTonimn(t.getTraversalObj(e,n),r,n)}})),parser_1=parser.parse,parser_2=parser.convertTonimn,parser_3=parser.getTraversalObj,parser_4=parser.convertToJson,parser_5=parser.convertToJsonString,parser_6=parser.validate,parser_7=parser.j2xParser,parser_8=parser.parseToNimn;function feature(e,t,r){if(!isObject(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");n&&validateBBox(n),o&&validateId(o);var a={type:"Feature"};return o&&(a.id=o),n&&(a.bbox=n),a.properties=t||{},a.geometry=e,a}function point(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!isNumber(e[0])||!isNumber(e[1]))throw new Error("coordinates must contain numbers");return feature({type:"Point",coordinates:e},t,r)}function featureCollection(e,t){if(!isObject(t=t||{}))throw new Error("options is invalid");var r=t.bbox,n=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");r&&validateBBox(r),n&&validateId(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=e,o}function isNumber(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function isObject(e){return!!e&&e.constructor===Object}function validateBBox(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!isNumber(e))throw new Error("bbox must only contain numbers")}))}function validateId(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function coordEach(e,t,r){if(null!==e)for(var n,o,a,i,s,l,u,c,g=0,p=0,h=e.type,f="FeatureCollection"===h,d="Feature"===h,y=f?e.features.length:1,m=0;m<y;m++){s=(c=!!(u=f?e.features[m].geometry:d?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var b=0;b<s;b++){var v=0,_=0;if(null!==(i=c?u.geometries[b]:u)){l=i.coordinates;var T=i.type;switch(g=!r||"Polygon"!==T&&"MultiPolygon"!==T?0:1,T){case null:break;case"Point":if(!1===t(l,p,m,v,_))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===t(l[n],p,m,v,_))return!1;p++,"MultiPoint"===T&&v++}"LineString"===T&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(o=0;o<l[n].length-g;o++){if(!1===t(l[n][o],p,m,v,_))return!1;p++}"MultiLineString"===T&&v++,"Polygon"===T&&_++}"Polygon"===T&&v++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for("MultiPolygon"===T&&(_=0),o=0;o<l[n].length;o++){for(a=0;a<l[n][o].length-g;a++){if(!1===t(l[n][o][a],p,m,v,_))return!1;p++}_++}v++}break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===coordEach(i.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function featureEach(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function explode(e){var t=[];return"FeatureCollection"===e.type?featureEach(e,(function(e){coordEach(e,(function(r){t.push(point(r,e.properties))}))})):coordEach(e,(function(r){t.push(point(r,e.properties))})),featureCollection(t)}function coordEach$1(e,t,r){if(null!==e)for(var n,o,a,i,s,l,u,c,g=0,p=0,h=e.type,f="FeatureCollection"===h,d="Feature"===h,y=f?e.features.length:1,m=0;m<y;m++){s=(c=!!(u=f?e.features[m].geometry:d?e.geometry:e)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var b=0;b<s;b++){var v=0,_=0;if(null!==(i=c?u.geometries[b]:u)){l=i.coordinates;var T=i.type;switch(g=!r||"Polygon"!==T&&"MultiPolygon"!==T?0:1,T){case null:break;case"Point":if(!1===t(l,p,m,v,_))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===t(l[n],p,m,v,_))return!1;p++,"MultiPoint"===T&&v++}"LineString"===T&&v++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(o=0;o<l[n].length-g;o++){if(!1===t(l[n][o],p,m,v,_))return!1;p++}"MultiLineString"===T&&v++,"Polygon"===T&&_++}"Polygon"===T&&v++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for("MultiPolygon"===T&&(_=0),o=0;o<l[n].length;o++){for(a=0;a<l[n][o].length-g;a++){if(!1===t(l[n][o][a],p,m,v,_))return!1;p++}_++}v++}break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===coordEach$1(i.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function bbox(e){var t=[1/0,1/0,-1/0,-1/0];return coordEach$1(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}function feature$1(e,t,r){if(!isObject$1(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");n&&validateBBox$1(n),o&&validateId$1(o);var a={type:"Feature"};return o&&(a.id=o),n&&(a.bbox=n),a.properties=t||{},a.geometry=e,a}function point$1(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!isNumber$1(e[0])||!isNumber$1(e[1]))throw new Error("coordinates must contain numbers");return feature$1({type:"Point",coordinates:e},t,r)}function isNumber$1(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function isObject$1(e){return!!e&&e.constructor===Object}function validateBBox$1(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!isNumber$1(e))throw new Error("bbox must only contain numbers")}))}function validateId$1(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function center(e,t){if(!isObject$1(t=t||{}))throw new Error("options is invalid");var r=t.properties;if(!e)throw new Error("geojson is required");var n=bbox(e);return point$1([(n[0]+n[2])/2,(n[1]+n[3])/2],r)}function clone(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return cloneFeature(e);case"FeatureCollection":return cloneFeatureCollection(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return cloneGeometry(e);default:throw new Error("unknown GeoJSON type")}}function cloneFeature(e){var t={type:"Feature"};return Object.keys(e).forEach((function(r){switch(r){case"type":case"properties":case"geometry":return;default:t[r]=e[r]}})),t.properties=cloneProperties(e.properties),t.geometry=cloneGeometry(e.geometry),t}function cloneProperties(e){var t={};return e?(Object.keys(e).forEach((function(r){var n=e[r];"object"==typeof n?null===n?t[r]=null:n.length?t[r]=n.map((function(e){return e})):t[r]=cloneProperties(n):t[r]=n})),t):t}function cloneFeatureCollection(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach((function(r){switch(r){case"type":case"features":return;default:t[r]=e[r]}})),t.features=e.features.map((function(e){return cloneFeature(e)})),t}function cloneGeometry(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?(t.geometries=e.geometries.map((function(e){return cloneGeometry(e)})),t):(t.coordinates=deepSlice(e.coordinates),t)}function deepSlice(e){return"object"!=typeof e[0]?e.slice():e.map((function(e){return deepSlice(e)}))}var earthRadius=6371008.8,factors={meters:earthRadius,metres:earthRadius,millimeters:1e3*earthRadius,millimetres:1e3*earthRadius,centimeters:100*earthRadius,centimetres:100*earthRadius,kilometers:earthRadius/1e3,kilometres:earthRadius/1e3,miles:earthRadius/1609.344,nauticalmiles:earthRadius/1852,inches:39.37*earthRadius,yards:earthRadius/1.0936,feet:3.28084*earthRadius,radians:1,degrees:earthRadius/111325};function radiansToLength(e,t){if(null==e)throw new Error("radians is required");if(t&&"string"!=typeof t)throw new Error("units must be a string");var r=factors[t||"kilometers"];if(!r)throw new Error(t+" units is invalid");return e*r}function degreesToRadians(e){if(null==e)throw new Error("degrees is required");return e%360*Math.PI/180}function isObject$2(e){return!!e&&e.constructor===Object}function getCoord(e){if(!e)throw new Error("coord is required");if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates;if(Array.isArray(e)&&e.length>=2&&void 0===e[0].length&&void 0===e[1].length)return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function distance(e,t,r){if(!isObject$2(r=r||{}))throw new Error("options is invalid");var n=r.units,o=getCoord(e),a=getCoord(t),i=degreesToRadians(a[1]-o[1]),s=degreesToRadians(a[0]-o[0]),l=degreesToRadians(o[1]),u=degreesToRadians(a[1]),c=Math.pow(Math.sin(i/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(l)*Math.cos(u);return radiansToLength(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),n)}function featureEach$1(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function nearestPoint(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var r,n=1/0;return featureEach$1(t,(function(t,o){var a=distance(e,t);a<n&&((r=clone(t)).properties.featureIndex=o,r.properties.distanceToPoint=a,n=a)})),r}function feature$2(e,t,r){if(!isObject$3(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");n&&validateBBox$2(n),o&&validateId$2(o);var a={type:"Feature"};return o&&(a.id=o),n&&(a.bbox=n),a.properties=t||{},a.geometry=e,a}function point$2(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!isNumber$2(e[0])||!isNumber$2(e[1]))throw new Error("coordinates must contain numbers");return feature$2({type:"Point",coordinates:e},t,r)}function featureCollection$1(e,t){if(!isObject$3(t=t||{}))throw new Error("options is invalid");var r=t.bbox,n=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");r&&validateBBox$2(r),n&&validateId$2(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=e,o}function isNumber$2(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function isObject$3(e){return!!e&&e.constructor===Object}function validateBBox$2(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!isNumber$2(e))throw new Error("bbox must only contain numbers")}))}function validateId$2(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function getCoord$1(e){if(!e)throw new Error("coord is required");if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates;if(Array.isArray(e)&&e.length>=2&&void 0===e[0].length&&void 0===e[1].length)return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function getCoords(e){if(!e)throw new Error("coords is required");if("Feature"===e.type&&null!==e.geometry)return e.geometry.coordinates;if(e.coordinates)return e.coordinates;if(Array.isArray(e))return e;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function booleanPointInPolygon(e,t,r){if("object"!=typeof(r=r||{}))throw new Error("options is invalid");var n=r.ignoreBoundary;if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var o=getCoord$1(e),a=getCoords(t),i=t.geometry?t.geometry.type:t.type,s=t.bbox;if(s&&!1===inBBox(o,s))return!1;"Polygon"===i&&(a=[a]);for(var l=0,u=!1;l<a.length&&!u;l++)if(inRing(o,a[l][0],n)){for(var c=!1,g=1;g<a[l].length&&!c;)inRing(o,a[l][g],!n)&&(c=!0),g++;c||(u=!0)}return u}function inRing(e,t,r){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,a=t.length-1;o<t.length;a=o++){var i=t[o][0],s=t[o][1],l=t[a][0],u=t[a][1];if(e[1]*(i-l)+s*(l-e[0])+u*(e[0]-i)==0&&(i-e[0])*(l-e[0])<=0&&(s-e[1])*(u-e[1])<=0)return!r;s>e[1]!=u>e[1]&&e[0]<(l-i)*(e[1]-s)/(u-s)+i&&(n=!n)}return n}function inBBox(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}function pointOnFeature(e){for(var t=normalize(e),r=center(t),n=!1,o=0;!n&&o<t.features.length;){var a,i=t.features[o].geometry,s=!1;if("Point"===i.type)r.geometry.coordinates[0]===i.coordinates[0]&&r.geometry.coordinates[1]===i.coordinates[1]&&(n=!0);else if("MultiPoint"===i.type){var l=!1;for(a=0;!l&&a<i.coordinates.length;)r.geometry.coordinates[0]===i.coordinates[a][0]&&r.geometry.coordinates[1]===i.coordinates[a][1]&&(n=!0,l=!0),a++}else if("LineString"===i.type)for(a=0;!s&&a<i.coordinates.length-1;)pointOnSegment(r.geometry.coordinates[0],r.geometry.coordinates[1],i.coordinates[a][0],i.coordinates[a][1],i.coordinates[a+1][0],i.coordinates[a+1][1])&&(s=!0,n=!0),a++;else if("MultiLineString"===i.type)for(var u=0;u<i.coordinates.length;){s=!1,a=0;for(var c=i.coordinates[u];!s&&a<c.length-1;)pointOnSegment(r.geometry.coordinates[0],r.geometry.coordinates[1],c[a][0],c[a][1],c[a+1][0],c[a+1][1])&&(s=!0,n=!0),a++;u++}else"Polygon"!==i.type&&"MultiPolygon"!==i.type||booleanPointInPolygon(r,i)&&(n=!0);o++}if(n)return r;var g=featureCollection$1([]);for(o=0;o<t.features.length;o++)g.features=g.features.concat(explode(t.features[o]).features);return point$2(nearestPoint(r,g).geometry.coordinates)}function normalize(e){return"FeatureCollection"!==e.type?"Feature"!==e.type?featureCollection$1([feature$2(e)]):featureCollection$1([e]):e}function pointOnSegment(e,t,r,n,o,a){return Math.sqrt((o-r)*(o-r)+(a-n)*(a-n))===Math.sqrt((e-r)*(e-r)+(t-n)*(t-n))+Math.sqrt((o-e)*(o-e)+(a-t)*(a-t))}var helpers=createCommonjsModule((function(e,t){function r(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function n(e,t,n){return void 0===n&&(n={}),r({type:"Point",coordinates:e},t,n)}function o(e,t,n){void 0===n&&(n={});for(var o=0,a=e;o<a.length;o++){var i=a[o];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<i[i.length-1].length;s++)if(i[i.length-1][s]!==i[0][s])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,n)}function a(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,n)}function i(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function s(e,t,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:e},t,n)}function l(e,t,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:e},t,n)}function u(e,t,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:e},t,n)}function c(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function g(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function p(e){return 180*(e%(2*Math.PI))/Math.PI}function h(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=function(e,t,r){switch(e){case"Point":return n(t).geometry;case"LineString":return a(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return l(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return u(t).geometry;default:throw new Error(e+" is invalid")}},t.point=n,t.points=function(e,t,r){return void 0===r&&(r={}),i(e.map((function(e){return n(e,t)})),r)},t.polygon=o,t.polygons=function(e,t,r){return void 0===r&&(r={}),i(e.map((function(e){return o(e,t)})),r)},t.lineString=a,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),i(e.map((function(e){return a(e,t)})),r)},t.featureCollection=i,t.multiLineString=s,t.multiPoint=l,t.multiPolygon=u,t.geometryCollection=function(e,t,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:e},t,n)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=c,t.lengthToRadians=g,t.lengthToDegrees=function(e,t){return p(g(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=p,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return c(g(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=t.areaFactors[r];if(!o)throw new Error("invalid original units");var a=t.areaFactors[n];if(!a)throw new Error("invalid final units");return e/o*a},t.isNumber=h,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!h(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}}));unwrapExports(helpers);var helpers_1=helpers.earthRadius,helpers_2=helpers.factors,helpers_3=helpers.unitsFactors,helpers_4=helpers.areaFactors,helpers_5=helpers.feature,helpers_6=helpers.geometry,helpers_7=helpers.point,helpers_8=helpers.points,helpers_9=helpers.polygon,helpers_10=helpers.polygons,helpers_11=helpers.lineString,helpers_12=helpers.lineStrings,helpers_13=helpers.featureCollection,helpers_14=helpers.multiLineString,helpers_15=helpers.multiPoint,helpers_16=helpers.multiPolygon,helpers_17=helpers.geometryCollection,helpers_18=helpers.round,helpers_19=helpers.radiansToLength,helpers_20=helpers.lengthToRadians,helpers_21=helpers.lengthToDegrees,helpers_22=helpers.bearingToAzimuth,helpers_23=helpers.radiansToDegrees,helpers_24=helpers.degreesToRadians,helpers_25=helpers.convertLength,helpers_26=helpers.convertArea,helpers_27=helpers.isNumber,helpers_28=helpers.isObject,helpers_29=helpers.validateBBox,helpers_30=helpers.validateId,helpers_31=helpers.radians2degrees,helpers_32=helpers.degrees2radians,helpers_33=helpers.distanceToDegrees,helpers_34=helpers.distanceToRadians,helpers_35=helpers.radiansToDistance,helpers_36=helpers.bearingToAngle,helpers_37=helpers.convertDistance,meta=createCommonjsModule((function(e,t){function r(e,t,n){if(null!==e)for(var o,a,i,s,l,u,c,g,p=0,h=0,f=e.type,d="FeatureCollection"===f,y="Feature"===f,m=d?e.features.length:1,b=0;b<m;b++){l=(g=!!(c=d?e.features[b].geometry:y?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var v=0;v<l;v++){var _=0,T=0;if(null!==(s=g?c.geometries[v]:c)){u=s.coordinates;var w=s.type;switch(p=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===t(u,h,b,_,T))return!1;h++,_++;break;case"LineString":case"MultiPoint":for(o=0;o<u.length;o++){if(!1===t(u[o],h,b,_,T))return!1;h++,"MultiPoint"===w&&_++}"LineString"===w&&_++;break;case"Polygon":case"MultiLineString":for(o=0;o<u.length;o++){for(a=0;a<u[o].length-p;a++){if(!1===t(u[o][a],h,b,_,T))return!1;h++}"MultiLineString"===w&&_++,"Polygon"===w&&T++}"Polygon"===w&&_++;break;case"MultiPolygon":for(o=0;o<u.length;o++){for(T=0,a=0;a<u[o].length;a++){for(i=0;i<u[o][a].length-p;i++){if(!1===t(u[o][a][i],h,b,_,T))return!1;h++}T++}_++}break;case"GeometryCollection":for(o=0;o<s.geometries.length;o++)if(!1===r(s.geometries[o],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function n(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function o(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function a(e,t){var r,n,o,a,i,s,l,u,c,g,p=0,h="FeatureCollection"===e.type,f="Feature"===e.type,d=h?e.features.length:1;for(r=0;r<d;r++){for(s=h?e.features[r].geometry:f?e.geometry:e,u=h?e.features[r].properties:f?e.properties:{},c=h?e.features[r].bbox:f?e.bbox:void 0,g=h?e.features[r].id:f?e.id:void 0,i=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<i;o++)if(null!==(a=l?s.geometries[o]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(a,p,u,c,g))return!1;break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===t(a.geometries[n],p,u,c,g))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,p,u,c,g))return!1;p++}}function i(e,t){a(e,(function(e,r,n,o,a){var i,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(helpers.feature(e,n,{bbox:o,id:a}),r,0)&&void 0}switch(s){case"MultiPoint":i="Point";break;case"MultiLineString":i="LineString";break;case"MultiPolygon":i="Polygon"}for(var l=0;l<e.coordinates.length;l++){var u={type:i,coordinates:e.coordinates[l]};if(!1===t(helpers.feature(u,n),r,l))return!1}}))}function s(e,t){i(e,(function(e,n,o){var a=0;if(e.geometry){var i=e.geometry.type;if("Point"!==i&&"MultiPoint"!==i){var s,l=0,u=0,c=0;return!1!==r(e,(function(r,i,g,p,h){if(void 0===s||n>l||p>u||h>c)return s=r,l=n,u=p,c=h,void(a=0);var f=helpers.lineString([s,r],e.properties);if(!1===t(f,n,o,h,a))return!1;a++,s=r}))&&void 0}}}))}function l(e,t){if(!e)throw new Error("geojson is required");i(e,(function(e,r,n){if(null!==e.geometry){var o=e.geometry.type,a=e.geometry.coordinates;switch(o){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var i=0;i<a.length;i++)if(!1===t(helpers.lineString(a[i],e.properties),r,n,i))return!1}}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.coordEach=r,t.coordReduce=function(e,t,n,o){var a=n;return r(e,(function(e,r,o,i,s){a=0===r&&void 0===n?e:t(a,e,r,o,i,s)}),o),a},t.propEach=n,t.propReduce=function(e,t,r){var o=r;return n(e,(function(e,n){o=0===n&&void 0===r?e:t(o,e,n)})),o},t.featureEach=o,t.featureReduce=function(e,t,r){var n=r;return o(e,(function(e,o){n=0===o&&void 0===r?e:t(n,e,o)})),n},t.coordAll=function(e){var t=[];return r(e,(function(e){t.push(e)})),t},t.geomEach=a,t.geomReduce=function(e,t,r){var n=r;return a(e,(function(e,o,a,i,s){n=0===o&&void 0===r?e:t(n,e,o,a,i,s)})),n},t.flattenEach=i,t.flattenReduce=function(e,t,r){var n=r;return i(e,(function(e,o,a){n=0===o&&0===a&&void 0===r?e:t(n,e,o,a)})),n},t.segmentEach=s,t.segmentReduce=function(e,t,r){var n=r,o=!1;return s(e,(function(e,a,i,s,l){n=!1===o&&void 0===r?e:t(n,e,a,i,s,l),o=!0})),n},t.lineEach=l,t.lineReduce=function(e,t,r){var n=r;return l(e,(function(e,o,a,i){n=0===o&&void 0===r?e:t(n,e,o,a,i)})),n},t.findSegment=function(e,t){if(t=t||{},!helpers.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,o=t.multiFeatureIndex||0,a=t.geometryIndex||0,i=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return i<0&&(i=l.length+i-1),helpers.lineString([l[i],l[i+1]],s,t);case"Polygon":return a<0&&(a=l.length+a),i<0&&(i=l[a].length+i-1),helpers.lineString([l[a][i],l[a][i+1]],s,t);case"MultiLineString":return o<0&&(o=l.length+o),i<0&&(i=l[o].length+i-1),helpers.lineString([l[o][i],l[o][i+1]],s,t);case"MultiPolygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a),i<0&&(i=l[o][a].length-i-1),helpers.lineString([l[o][a][i],l[o][a][i+1]],s,t)}throw new Error("geojson is invalid")},t.findPoint=function(e,t){if(t=t||{},!helpers.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,o=t.multiFeatureIndex||0,a=t.geometryIndex||0,i=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":return helpers.point(l,s,t);case"MultiPoint":return o<0&&(o=l.length+o),helpers.point(l[o],s,t);case"LineString":return i<0&&(i=l.length+i),helpers.point(l[i],s,t);case"Polygon":return a<0&&(a=l.length+a),i<0&&(i=l[a].length+i),helpers.point(l[a][i],s,t);case"MultiLineString":return o<0&&(o=l.length+o),i<0&&(i=l[o].length+i),helpers.point(l[o][i],s,t);case"MultiPolygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a),i<0&&(i=l[o][a].length-i),helpers.point(l[o][a][i],s,t)}throw new Error("geojson is invalid")}}));unwrapExports(meta);var meta_1=meta.coordEach,meta_2=meta.coordReduce,meta_3=meta.propEach,meta_4=meta.propReduce,meta_5=meta.featureEach,meta_6=meta.featureReduce,meta_7=meta.coordAll,meta_8=meta.geomEach,meta_9=meta.geomReduce,meta_10=meta.flattenEach,meta_11=meta.flattenReduce,meta_12=meta.segmentEach,meta_13=meta.segmentReduce,meta_14=meta.lineEach,meta_15=meta.lineReduce,meta_16=meta.findSegment,meta_17=meta.findPoint,area_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=6378137;function n(e){var t=0;if(e&&e.length>0){t+=Math.abs(o(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(o(e[r]))}return t}function o(e){var t,n,o,i,s,l,u=0,c=e.length;if(c>2){for(l=0;l<c;l++)l===c-2?(o=c-2,i=c-1,s=0):l===c-1?(o=c-1,i=0,s=1):(o=l,i=l+1,s=l+2),t=e[o],n=e[i],u+=(a(e[s][0])-a(t[0]))*Math.sin(a(n[1]));u=u*r*r/2}return u}function a(e){return e*Math.PI/180}t.default=function(e){return meta.geomReduce(e,(function(e,t){return e+function(e){var t,r=0;switch(e.type){case"Polygon":return n(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)r+=n(e.coordinates[t]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)}),0)}})),area=unwrapExports(area_1),invariant=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getCoord=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},t.getCoords=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},t.containsNumber=function e(t){if(t.length>1&&helpers.isNumber(t[0])&&helpers.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")},t.geojsonType=function(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)},t.featureOf=function(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)},t.collectionOf=function(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,o=e.features;n<o.length;n++){var a=o[n];if(!a||"Feature"!==a.type||!a.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!a.geometry||a.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+a.geometry.type)}},t.getGeom=function(e){return"Feature"===e.type?e.geometry:e},t.getType=function(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}}));unwrapExports(invariant);var invariant_1=invariant.getCoord,invariant_2=invariant.getCoords,invariant_3=invariant.containsNumber,invariant_4=invariant.geojsonType,invariant_5=invariant.featureOf,invariant_6=invariant.collectionOf,invariant_7=invariant.getGeom,invariant_8=invariant.getType,booleanPointInPolygon_1=createCommonjsModule((function(e,t){function r(e,t,r){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,a=t.length-1;o<t.length;a=o++){var i=t[o][0],s=t[o][1],l=t[a][0],u=t[a][1];if(e[1]*(i-l)+s*(l-e[0])+u*(e[0]-i)==0&&(i-e[0])*(l-e[0])<=0&&(s-e[1])*(u-e[1])<=0)return!r;s>e[1]!=u>e[1]&&e[0]<(l-i)*(e[1]-s)/(u-s)+i&&(n=!n)}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var o=invariant.getCoord(e),a=invariant.getGeom(t),i=a.type,s=t.bbox,l=a.coordinates;if(s&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(o,s))return!1;"Polygon"===i&&(l=[l]);for(var u=!1,c=0;c<l.length&&!u;c++)if(r(o,l[c][0],n.ignoreBoundary)){for(var g=!1,p=1;p<l[c].length&&!g;)r(o,l[c][p],!n.ignoreBoundary)&&(g=!0),p++;g||(u=!0)}return u}})),booleanPointInPolygon$1=unwrapExports(booleanPointInPolygon_1),bboxPolygon_1=createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){void 0===t&&(t={});var r=Number(e[0]),n=Number(e[1]),o=Number(e[2]),a=Number(e[3]);if(6===e.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var i=[r,n],s=[r,a],l=[o,a],u=[o,n];return helpers.polygon([[i,u,l,s,i]],t.properties,{bbox:e,id:t.id})}})),bboxPolygon=unwrapExports(bboxPolygon_1);function listCacheClear(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear;function eq(e,t){return e===t||e!=e&&t!=t}var eq_1=eq;function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq_1(e[r][0],t))return r;return-1}var _assocIndexOf=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,r=_assocIndexOf(t,e);return!(r<0)&&(r==t.length-1?t.pop():splice.call(t,r,1),--this.size,!0)}var _listCacheDelete=listCacheDelete;function listCacheGet(e){var t=this.__data__,r=_assocIndexOf(t,e);return r<0?void 0:t[r][1]}var _listCacheGet=listCacheGet;function listCacheHas(e){return _assocIndexOf(this.__data__,e)>-1}var _listCacheHas=listCacheHas;function listCacheSet(e,t){var r=this.__data__,n=_assocIndexOf(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var _listCacheSet=listCacheSet;function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache;function stackClear(){this.__data__=new _ListCache,this.size=0}var _stackClear=stackClear;function stackDelete(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var _stackDelete=stackDelete;function stackGet(e){return this.__data__.get(e)}var _stackGet=stackGet;function stackHas(e){return this.__data__.has(e)}var _stackHas=stackHas,freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")(),_root=root,Symbol$1=_root.Symbol,_Symbol=Symbol$1,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty.call(e,symToStringTag),r=e[symToStringTag];try{e[symToStringTag]=void 0;var n=!0}catch(e){}var o=nativeObjectToString.call(e);return n&&(t?e[symToStringTag]=r:delete e[symToStringTag]),o}var _getRawTag=getRawTag,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(e){return nativeObjectToString$1.call(e)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(e)?_getRawTag(e):_objectToString(e)}var _baseGetTag=baseGetTag;function isObject$4(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject$4,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!isObject_1(e))return!1;var t=_baseGetTag(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=function(){var e=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject_1(e)||_isMasked(e))&&(isFunction_1(e)?reIsNative:reIsHostCtor).test(_toSource(e))}var _baseIsNative=baseIsNative;function getValue$1(e,t){return null==e?void 0:e[t]}var _getValue=getValue$1;function getNative(e,t){var r=_getValue(e,t);return _baseIsNative(r)?r:void 0}var _getNative=getNative,Map=_getNative(_root,"Map"),_Map=Map,nativeCreate=_getNative(Object,"create"),_nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}var _hashClear=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete=hashDelete,HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty;function hashGet(e){var t=this.__data__;if(_nativeCreate){var r=t[e];return r===HASH_UNDEFINED?void 0:r}return hasOwnProperty$2.call(t,e)?t[e]:void 0}var _hashGet=hashGet,objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function hashHas(e){var t=this.__data__;return _nativeCreate?void 0!==t[e]:hasOwnProperty$3.call(t,e)}var _hashHas=hashHas,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=_nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}var _hashSet=hashSet;function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;var _Hash=Hash;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}var _mapCacheClear=mapCacheClear;function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable;function getMapData(e,t){var r=e.__data__;return _isKeyable(t)?r["string"==typeof t?"string":"hash"]:r.map}var _getMapData=getMapData;function mapCacheDelete(e){var t=_getMapData(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete;function mapCacheGet(e){return _getMapData(this,e).get(e)}var _mapCacheGet=mapCacheGet;function mapCacheHas(e){return _getMapData(this,e).has(e)}var _mapCacheHas=mapCacheHas;function mapCacheSet(e,t){var r=_getMapData(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var _mapCacheSet=mapCacheSet;function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache,LARGE_ARRAY_SIZE=200;function stackSet(e,t){var r=this.__data__;if(r instanceof _ListCache){var n=r.__data__;if(!_Map||n.length<LARGE_ARRAY_SIZE-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new _MapCache(n)}return r.set(e,t),this.size=r.size,this}var _stackSet=stackSet;function Stack(e){var t=this.__data__=new _ListCache(e);this.size=t.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;var _Stack=Stack;function arrayEach(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}var _arrayEach=arrayEach,defineProperty=function(){try{var e=_getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),_defineProperty=defineProperty;function baseAssignValue(e,t,r){"__proto__"==t&&_defineProperty?_defineProperty(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var _baseAssignValue=baseAssignValue,objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function assignValue(e,t,r){var n=e[t];hasOwnProperty$4.call(e,t)&&eq_1(n,r)&&(void 0!==r||t in e)||_baseAssignValue(e,t,r)}var _assignValue=assignValue;function copyObject(e,t,r,n){var o=!r;r||(r={});for(var a=-1,i=t.length;++a<i;){var s=t[a],l=n?n(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),o?_baseAssignValue(r,s,l):_assignValue(r,s,l)}return r}var _copyObject=copyObject;function baseTimes(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var _baseTimes=baseTimes;function isObjectLike(e){return null!=e&&"object"==typeof e}var isObjectLike_1=isObjectLike,argsTag="[object Arguments]";function baseIsArguments(e){return isObjectLike_1(e)&&_baseGetTag(e)==argsTag}var _baseIsArguments=baseIsArguments,objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty,propertyIsEnumerable=objectProto$6.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(e){return isObjectLike_1(e)&&hasOwnProperty$5.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")},isArguments_1=isArguments,isArray=Array.isArray,isArray_1=isArray;function stubFalse(){return!1}var stubFalse_1=stubFalse,isBuffer_1=createCommonjsModule((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?_root.Buffer:void 0,a=(o?o.isBuffer:void 0)||stubFalse_1;e.exports=a})),MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}var _isIndex=isIndex,MAX_SAFE_INTEGER$1=9007199254740991;function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$1}var isLength_1=isLength,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike_1(e)&&isLength_1(e.length)&&!!typedArrayTags[_baseGetTag(e)]}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var _baseIsTypedArray=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}var _baseUnary=baseUnary,_nodeUtil=createCommonjsModule((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r&&_freeGlobal.process,a=function(){try{var e=n&&n.require&&n.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a})),nodeIsTypedArray=_nodeUtil&&_nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?_baseUnary(nodeIsTypedArray):_baseIsTypedArray,isTypedArray_1=isTypedArray,objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function arrayLikeKeys(e,t){var r=isArray_1(e),n=!r&&isArguments_1(e),o=!r&&!n&&isBuffer_1(e),a=!r&&!n&&!o&&isTypedArray_1(e),i=r||n||o||a,s=i?_baseTimes(e.length,String):[],l=s.length;for(var u in e)!t&&!hasOwnProperty$6.call(e,u)||i&&("length"==u||o&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||_isIndex(u,l))||s.push(u);return s}var _arrayLikeKeys=arrayLikeKeys,objectProto$8=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$8)}var _isPrototype=isPrototype;function overArg(e,t){return function(r){return e(t(r))}}var _overArg=overArg,nativeKeys=_overArg(Object.keys,Object),_nativeKeys=nativeKeys,objectProto$9=Object.prototype,hasOwnProperty$7=objectProto$9.hasOwnProperty;function baseKeys(e){if(!_isPrototype(e))return _nativeKeys(e);var t=[];for(var r in Object(e))hasOwnProperty$7.call(e,r)&&"constructor"!=r&&t.push(r);return t}var _baseKeys=baseKeys;function isArrayLike(e){return null!=e&&isLength_1(e.length)&&!isFunction_1(e)}var isArrayLike_1=isArrayLike;function keys(e){return isArrayLike_1(e)?_arrayLikeKeys(e):_baseKeys(e)}var keys_1=keys;function baseAssign(e,t){return e&&_copyObject(t,keys_1(t),e)}var _baseAssign=baseAssign;function nativeKeysIn(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var _nativeKeysIn=nativeKeysIn,objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty;function baseKeysIn(e){if(!isObject_1(e))return _nativeKeysIn(e);var t=_isPrototype(e),r=[];for(var n in e)("constructor"!=n||!t&&hasOwnProperty$8.call(e,n))&&r.push(n);return r}var _baseKeysIn=baseKeysIn;function keysIn$1(e){return isArrayLike_1(e)?_arrayLikeKeys(e,!0):_baseKeysIn(e)}var keysIn_1=keysIn$1;function baseAssignIn(e,t){return e&&_copyObject(t,keysIn_1(t),e)}var _baseAssignIn=baseAssignIn,_cloneBuffer=createCommonjsModule((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?_root.Buffer:void 0,a=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}}));function copyArray(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var _copyArray=copyArray;function arrayFilter(e,t){for(var r=-1,n=null==e?0:e.length,o=0,a=[];++r<n;){var i=e[r];t(i,r,e)&&(a[o++]=i)}return a}var _arrayFilter=arrayFilter;function stubArray(){return[]}var stubArray_1=stubArray,objectProto$b=Object.prototype,propertyIsEnumerable$1=objectProto$b.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return null==e?[]:(e=Object(e),_arrayFilter(nativeGetSymbols(e),(function(t){return propertyIsEnumerable$1.call(e,t)})))}:stubArray_1,_getSymbols=getSymbols;function copySymbols(e,t){return _copyObject(e,_getSymbols(e),t)}var _copySymbols=copySymbols;function arrayPush(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var _arrayPush=arrayPush,getPrototype=_overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols$1?function(e){for(var t=[];e;)_arrayPush(t,_getSymbols(e)),e=_getPrototype(e);return t}:stubArray_1,_getSymbolsIn=getSymbolsIn;function copySymbolsIn(e,t){return _copyObject(e,_getSymbolsIn(e),t)}var _copySymbolsIn=copySymbolsIn;function baseGetAllKeys(e,t,r){var n=t(e);return isArray_1(e)?n:_arrayPush(n,r(e))}var _baseGetAllKeys=baseGetAllKeys;function getAllKeys(e){return _baseGetAllKeys(e,keys_1,_getSymbols)}var _getAllKeys=getAllKeys;function getAllKeysIn(e){return _baseGetAllKeys(e,keysIn_1,_getSymbolsIn)}var _getAllKeysIn=getAllKeysIn,DataView=_getNative(_root,"DataView"),_DataView=DataView,Promise=_getNative(_root,"Promise"),_Promise=Promise,Set=_getNative(_root,"Set"),_Set=Set,WeakMap=_getNative(_root,"WeakMap"),_WeakMap=WeakMap,mapTag$1="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$1="[object DataView]",dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_baseGetTag;(_DataView&&getTag(new _DataView(new ArrayBuffer(1)))!=dataViewTag$1||_Map&&getTag(new _Map)!=mapTag$1||_Promise&&getTag(_Promise.resolve())!=promiseTag||_Set&&getTag(new _Set)!=setTag$1||_WeakMap&&getTag(new _WeakMap)!=weakMapTag$1)&&(getTag=function(e){var t=_baseGetTag(e),r=t==objectTag$1?e.constructor:void 0,n=r?_toSource(r):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag$1}return t});var _getTag=getTag,objectProto$c=Object.prototype,hasOwnProperty$9=objectProto$c.hasOwnProperty;function initCloneArray(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$9.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var _initCloneArray=initCloneArray,Uint8Array=_root.Uint8Array,_Uint8Array=Uint8Array;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new _Uint8Array(t).set(new _Uint8Array(e)),t}var _cloneArrayBuffer=cloneArrayBuffer;function cloneDataView(e,t){var r=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var _cloneDataView=cloneDataView,reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var _cloneRegExp=cloneRegExp,symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol(e){return symbolValueOf?Object(symbolValueOf.call(e)):{}}var _cloneSymbol=cloneSymbol;function cloneTypedArray(e,t){var r=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var _cloneTypedArray=cloneTypedArray,boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,t,r){var n=e.constructor;switch(t){case arrayBufferTag$1:return _cloneArrayBuffer(e);case boolTag$1:case dateTag$1:return new n(+e);case dataViewTag$2:return _cloneDataView(e,r);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return _cloneTypedArray(e,r);case mapTag$2:return new n;case numberTag$1:case stringTag$1:return new n(e);case regexpTag$1:return _cloneRegExp(e);case setTag$2:return new n;case symbolTag:return _cloneSymbol(e)}}var _initCloneByTag=initCloneByTag,objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject_1(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),_baseCreate=baseCreate;function initCloneObject(e){return"function"!=typeof e.constructor||_isPrototype(e)?{}:_baseCreate(_getPrototype(e))}var _initCloneObject=initCloneObject,mapTag$3="[object Map]";function baseIsMap(e){return isObjectLike_1(e)&&_getTag(e)==mapTag$3}var _baseIsMap=baseIsMap,nodeIsMap=_nodeUtil&&_nodeUtil.isMap,isMap=nodeIsMap?_baseUnary(nodeIsMap):_baseIsMap,isMap_1=isMap,setTag$3="[object Set]";function baseIsSet(e){return isObjectLike_1(e)&&_getTag(e)==setTag$3}var _baseIsSet=baseIsSet,nodeIsSet=_nodeUtil&&_nodeUtil.isSet,isSet=nodeIsSet?_baseUnary(nodeIsSet):_baseIsSet,isSet_1=isSet,CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,argsTag$2="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$2="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag$2="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",cloneableTags={};function baseClone(e,t,r,n,o,a){var i,s=t&CLONE_DEEP_FLAG,l=t&CLONE_FLAT_FLAG,u=t&CLONE_SYMBOLS_FLAG;if(r&&(i=o?r(e,n,o,a):r(e)),void 0!==i)return i;if(!isObject_1(e))return e;var c=isArray_1(e);if(c){if(i=_initCloneArray(e),!s)return _copyArray(e,i)}else{var g=_getTag(e),p=g==funcTag$2||g==genTag$1;if(isBuffer_1(e))return _cloneBuffer(e,s);if(g==objectTag$2||g==argsTag$2||p&&!o){if(i=l||p?{}:_initCloneObject(e),!s)return l?_copySymbolsIn(e,_baseAssignIn(i,e)):_copySymbols(e,_baseAssign(i,e))}else{if(!cloneableTags[g])return o?e:{};i=_initCloneByTag(e,g,s)}}a||(a=new _Stack);var h=a.get(e);if(h)return h;a.set(e,i),isSet_1(e)?e.forEach((function(n){i.add(baseClone(n,t,r,n,e,a))})):isMap_1(e)&&e.forEach((function(n,o){i.set(o,baseClone(n,t,r,o,e,a))}));var f=u?l?_getAllKeysIn:_getAllKeys:l?keysIn:keys_1,d=c?void 0:f(e);return _arrayEach(d||e,(function(n,o){d&&(n=e[o=n]),_assignValue(i,o,baseClone(n,t,r,o,e,a))})),i}cloneableTags[argsTag$2]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$2]=cloneableTags[dataViewTag$3]=cloneableTags[boolTag$2]=cloneableTags[dateTag$2]=cloneableTags[float32Tag$2]=cloneableTags[float64Tag$2]=cloneableTags[int8Tag$2]=cloneableTags[int16Tag$2]=cloneableTags[int32Tag$2]=cloneableTags[mapTag$4]=cloneableTags[numberTag$2]=cloneableTags[objectTag$2]=cloneableTags[regexpTag$2]=cloneableTags[setTag$4]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag$2]=cloneableTags[uint8ClampedTag$2]=cloneableTags[uint16Tag$2]=cloneableTags[uint32Tag$2]=!0,cloneableTags[errorTag$1]=cloneableTags[funcTag$2]=cloneableTags[weakMapTag$2]=!1;var _baseClone=baseClone,CLONE_SYMBOLS_FLAG$1=4;function clone$1(e){return _baseClone(e,CLONE_SYMBOLS_FLAG$1)}var clone_1=clone$1;function DEFAULT_COMPARE(e,t){return e>t?1:e<t?-1:0}class SplayTree{constructor(e=DEFAULT_COMPARE,t=!1){this._compare=e,this._root=null,this._size=0,this._noDuplicates=!!t}rotateLeft(e){var t=e.right;t&&(e.right=t.left,t.left&&(t.left.parent=e),t.parent=e.parent),e.parent?e===e.parent.left?e.parent.left=t:e.parent.right=t:this._root=t,t&&(t.left=e),e.parent=t}rotateRight(e){var t=e.left;t&&(e.left=t.right,t.right&&(t.right.parent=e),t.parent=e.parent),e.parent?e===e.parent.left?e.parent.left=t:e.parent.right=t:this._root=t,t&&(t.right=e),e.parent=t}_splay(e){for(;e.parent;){var t=e.parent;t.parent?t.left===e&&t.parent.left===t?(this.rotateRight(t.parent),this.rotateRight(t)):t.right===e&&t.parent.right===t?(this.rotateLeft(t.parent),this.rotateLeft(t)):t.left===e&&t.parent.right===t?(this.rotateRight(t),this.rotateLeft(t)):(this.rotateLeft(t),this.rotateRight(t)):t.left===e?this.rotateRight(t):this.rotateLeft(t)}}splay(e){for(var t,r,n,o,a;e.parent;)(r=(t=e.parent).parent)&&r.parent?((n=r.parent).left===r?n.left=e:n.right=e,e.parent=n):(e.parent=null,this._root=e),o=e.left,a=e.right,e===t.left?(r&&(r.left===t?(t.right?(r.left=t.right,r.left.parent=r):r.left=null,t.right=r,r.parent=t):(o?(r.right=o,o.parent=r):r.right=null,e.left=r,r.parent=e)),a?(t.left=a,a.parent=t):t.left=null,e.right=t,t.parent=e):(r&&(r.right===t?(t.left?(r.right=t.left,r.right.parent=r):r.right=null,t.left=r,r.parent=t):(a?(r.left=a,a.parent=r):r.left=null,e.right=r,r.parent=e)),o?(t.right=o,o.parent=t):t.right=null,e.left=t,t.parent=e)}replace(e,t){e.parent?e===e.parent.left?e.parent.left=t:e.parent.right=t:this._root=t,t&&(t.parent=e.parent)}minNode(e=this._root){if(e)for(;e.left;)e=e.left;return e}maxNode(e=this._root){if(e)for(;e.right;)e=e.right;return e}insert(e,t){var r=this._root,n=null,o=this._compare;if(this._noDuplicates)for(;r;){if(n=r,0===o(r.key,e))return;r=o(r.key,e)<0?r.right:r.left}else for(;r;)n=r,r=o(r.key,e)<0?r.right:r.left;return r={key:e,data:t,left:null,right:null,parent:n},n?o(n.key,r.key)<0?n.right=r:n.left=r:this._root=r,this.splay(r),this._size++,r}find(e){for(var t=this._root,r=this._compare;t;){var n=r(t.key,e);if(n<0)t=t.right;else{if(!(n>0))return t;t=t.left}}return null}contains(e){for(var t=this._root,r=this._compare;t;){var n=r(e,t.key);if(0===n)return!0;t=n<0?t.left:t.right}return!1}remove(e){var t=this.find(e);if(!t)return!1;if(this.splay(t),t.left)if(t.right){var r=this.minNode(t.right);r.parent!==t&&(this.replace(r,r.right),r.right=t.right,r.right.parent=r),this.replace(t,r),r.left=t.left,r.left.parent=r}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0}removeNode(e){if(!e)return!1;if(this.splay(e),e.left)if(e.right){var t=this.minNode(e.right);t.parent!==e&&(this.replace(t,t.right),t.right=e.right,t.right.parent=t),this.replace(e,t),t.left=e.left,t.left.parent=t}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0}erase(e){var t=this.find(e);if(t){this.splay(t);var r=t.left,n=t.right,o=null;r&&(r.parent=null,o=this.maxNode(r),this.splay(o),this._root=o),n&&(r?o.right=n:this._root=n,n.parent=o),this._size--}}pop(){var e=this._root,t=null;if(e){for(;e.left;)e=e.left;t={key:e.key,data:e.data},this.remove(e.key)}return t}next(e){var t=e;if(t)if(t.right)for(t=t.right;t&&t.left;)t=t.left;else for(t=e.parent;t&&t.right===e;)e=t,t=t.parent;return t}prev(e){var t=e;if(t)if(t.left)for(t=t.left;t&&t.right;)t=t.right;else for(t=e.parent;t&&t.left===e;)e=t,t=t.parent;return t}forEach(e){for(var t=this._root,r=[],n=!1,o=0;!n;)t?(r.push(t),t=t.left):r.length>0?(e(t=r.pop(),o++),t=t.right):n=!0;return this}range(e,t,r,n){const o=[],a=this._compare;let i,s=this._root;for(;0!==o.length||s;)if(s)o.push(s),s=s.left;else{if((i=a((s=o.pop()).key,t))>0)break;if(a(s.key,e)>=0&&r.call(n,s))return this;s=s.right}return this}keys(){for(var e=this._root,t=[],r=[],n=!1;!n;)e?(t.push(e),e=e.left):t.length>0?(e=t.pop(),r.push(e.key),e=e.right):n=!0;return r}values(){for(var e=this._root,t=[],r=[],n=!1;!n;)e?(t.push(e),e=e.left):t.length>0?(e=t.pop(),r.push(e.data),e=e.right):n=!0;return r}at(e){for(var t=this._root,r=[],n=!1,o=0;!n;)if(t)r.push(t),t=t.left;else if(r.length>0){if(t=r.pop(),o===e)return t;o++,t=t.right}else n=!0;return null}load(e=[],t=[],r=!1){if(0!==this._size)throw new Error("bulk-load: tree is not empty");const n=e.length;return r&&sort(e,t,0,n-1,this._compare),this._root=loadRecursive(null,e,t,0,n),this._size=n,this}min(){var e=this.minNode(this._root);return e?e.key:null}max(){var e=this.maxNode(this._root);return e?e.key:null}isEmpty(){return null===this._root}get size(){return this._size}static createTree(e,t,r,n,o){return new SplayTree(r,o).load(e,t,n)}}function loadRecursive(e,t,r,n,o){const a=o-n;if(a>0){const i=n+Math.floor(a/2),s={key:t[i],data:r[i],parent:e};return s.left=loadRecursive(s,t,r,n,i),s.right=loadRecursive(s,t,r,i+1,o),s}return null}function sort(e,t,r,n,o){if(r>=n)return;const a=e[r+n>>1];let i=r-1,s=n+1;for(;;){do{i++}while(o(e[i],a)<0);do{s--}while(o(e[s],a)>0);if(i>=s)break;let r=e[i];e[i]=e[s],e[s]=r,r=t[i],t[i]=t[s],t[s]=r}sort(e,t,r,s,o),sort(e,t,s+1,n,o)}const NORMAL=0,NON_CONTRIBUTING=1,SAME_TRANSITION=2,DIFFERENT_TRANSITION=3,INTERSECTION=0,UNION=1,DIFFERENCE=2,XOR=3;function computeFields(e,t,r){null===t?(e.inOut=!1,e.otherInOut=!0):(e.isSubject===t.isSubject?(e.inOut=!t.inOut,e.otherInOut=t.otherInOut):(e.inOut=!t.otherInOut,e.otherInOut=t.isVertical()?!t.inOut:t.inOut),t&&(e.prevInResult=!inResult(t,r)||t.isVertical()?t.prevInResult:t)),e.inResult=inResult(e,r)}function inResult(e,t){switch(e.type){case NORMAL:switch(t){case INTERSECTION:return!e.otherInOut;case UNION:return e.otherInOut;case DIFFERENCE:return e.isSubject&&e.otherInOut||!e.isSubject&&!e.otherInOut;case XOR:return!0}break;case SAME_TRANSITION:return t===INTERSECTION||t===UNION;case DIFFERENT_TRANSITION:return t===DIFFERENCE;case NON_CONTRIBUTING:return!1}return!1}class SweepEvent{constructor(e,t,r,n,o){this.left=t,this.point=e,this.otherEvent=r,this.isSubject=n,this.type=o||NORMAL,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.inResult=!1,this.resultInOut=!1,this.isExteriorRing=!0}isBelow(e){const t=this.point,r=this.otherEvent.point;return this.left?(t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1])>0:(r[0]-e[0])*(t[1]-e[1])-(t[0]-e[0])*(r[1]-e[1])>0}isAbove(e){return!this.isBelow(e)}isVertical(){return this.point[0]===this.otherEvent.point[0]}clone(){const e=new SweepEvent(this.point,this.left,this.otherEvent,this.isSubject,this.type);return e.inResult=this.inResult,e.prevInResult=this.prevInResult,e.isExteriorRing=this.isExteriorRing,e.inOut=this.inOut,e.otherInOut=this.otherInOut,e}}function equals(e,t){return e[0]===t[0]&&e[1]===t[1]}function signedArea(e,t,r){return(e[0]-r[0])*(t[1]-r[1])-(t[0]-r[0])*(e[1]-r[1])}function compareEvents(e,t){const r=e.point,n=t.point;return r[0]>n[0]?1:r[0]<n[0]?-1:r[1]!==n[1]?r[1]>n[1]?1:-1:specialCases(e,t,r)}function specialCases(e,t,r,n){return e.left!==t.left?e.left?1:-1:0!==signedArea(r,e.otherEvent.point,t.otherEvent.point)?e.isBelow(t.otherEvent.point)?-1:1:!e.isSubject&&t.isSubject?1:-1}function divideSegment(e,t,r){const n=new SweepEvent(t,!1,e,e.isSubject),o=new SweepEvent(t,!0,e.otherEvent,e.isSubject);return equals(e.point,e.otherEvent.point)&&console.warn("what is that, a collapsed segment?",e),n.contourId=o.contourId=e.contourId,compareEvents(o,e.otherEvent)>0&&(e.otherEvent.left=!0,o.left=!1),e.otherEvent.otherEvent=o,e.otherEvent=n,r.push(o),r.push(n),r}function crossProduct(e,t){return e[0]*t[1]-e[1]*t[0]}function dotProduct(e,t){return e[0]*t[0]+e[1]*t[1]}function intersection(e,t,r,n,o){const a=[t[0]-e[0],t[1]-e[1]],i=[n[0]-r[0],n[1]-r[1]];function s(e,t,r){return[e[0]+t*r[0],e[1]+t*r[1]]}const l=[r[0]-e[0],r[1]-e[1]];let u=crossProduct(a,i),c=u*u;const g=dotProduct(a,a);if(c>0){const t=crossProduct(l,i)/u;if(t<0||t>1)return null;const n=crossProduct(l,a)/u;return n<0||n>1?null:0===t||1===t?o?null:[s(e,t,a)]:0===n||1===n?o?null:[s(r,n,i)]:[s(e,t,a)]}if((c=(u=crossProduct(l,a))*u)>0)return null;const p=dotProduct(a,l)/g,h=p+dotProduct(a,i)/g,f=Math.min(p,h),d=Math.max(p,h);return f<=1&&d>=0?1===f?o?null:[s(e,f>0?f:0,a)]:0===d?o?null:[s(e,d<1?d:1,a)]:o&&0===f&&1===d?null:[s(e,f>0?f:0,a),s(e,d<1?d:1,a)]:null}function possibleIntersection(e,t,r){const n=intersection(e.point,e.otherEvent.point,t.point,t.otherEvent.point),o=n?n.length:0;if(0===o)return 0;if(1===o&&(equals(e.point,t.point)||equals(e.otherEvent.point,t.otherEvent.point)))return 0;if(2===o&&e.isSubject===t.isSubject)return 0;if(1===o)return equals(e.point,n[0])||equals(e.otherEvent.point,n[0])||divideSegment(e,n[0],r),equals(t.point,n[0])||equals(t.otherEvent.point,n[0])||divideSegment(t,n[0],r),1;const a=[];let i=!1,s=!1;return equals(e.point,t.point)?i=!0:1===compareEvents(e,t)?a.push(t,e):a.push(e,t),equals(e.otherEvent.point,t.otherEvent.point)?s=!0:1===compareEvents(e.otherEvent,t.otherEvent)?a.push(t.otherEvent,e.otherEvent):a.push(e.otherEvent,t.otherEvent),i&&s||i?(t.type=NON_CONTRIBUTING,e.type=t.inOut===e.inOut?SAME_TRANSITION:DIFFERENT_TRANSITION,i&&!s&&divideSegment(a[1].otherEvent,a[0].point,r),2):s?(divideSegment(a[0],a[1].point,r),3):a[0]!==a[3].otherEvent?(divideSegment(a[0],a[1].point,r),divideSegment(a[1],a[2].point,r),3):(divideSegment(a[0],a[1].point,r),divideSegment(a[3].otherEvent,a[2].point,r),3)}function compareSegments(e,t){if(e===t)return 0;if(0!==signedArea(e.point,e.otherEvent.point,t.point)||0!==signedArea(e.point,e.otherEvent.point,t.otherEvent.point))return equals(e.point,t.point)?e.isBelow(t.otherEvent.point)?-1:1:e.point[0]===t.point[0]?e.point[1]<t.point[1]?-1:1:1===compareEvents(e,t)?t.isAbove(e.point)?-1:1:e.isBelow(t.point)?-1:1;if(e.isSubject!==t.isSubject)return e.isSubject?-1:1;{let r=e.point,n=t.point;if(r[0]===n[0]&&r[1]===n[1])return r=e.otherEvent.point,n=t.otherEvent.point,r[0]===n[0]&&r[1]===n[1]?0:e.contourId>t.contourId?1:-1}return 1===compareEvents(e,t)?1:-1}function subdivide(e,t,r,n,o,a){const i=new SplayTree(compareSegments),s=[],l=Math.min(n[2],o[2]);let u,c,g;for(;0!==e.length;){let t=e.pop();if(s.push(t),a===INTERSECTION&&t.point[0]>l||a===DIFFERENCE&&t.point[0]>n[2])break;if(t.left){c=u=i.insert(t),u=u!==(g=i.minNode())?i.prev(u):null,c=i.next(c);const r=u?u.key:null;let n;if(computeFields(t,r,a),c&&2===possibleIntersection(t,c.key,e)&&(computeFields(t,r,a),computeFields(t,c.key,a)),u&&2===possibleIntersection(u.key,t,e)){let e=u;computeFields(r,n=(e=e!==g?i.prev(e):null)?e.key:null,a),computeFields(t,r,a)}}else t=t.otherEvent,c=u=i.find(t),u&&c&&(u=u!==g?i.prev(u):null,c=i.next(c),i.remove(t),c&&u&&possibleIntersection(u.key,c.key,e))}return s}function orderEvents(e){let t,r,n,o;const a=[];for(r=0,n=e.length;r<n;r++)((t=e[r]).left&&t.inResult||!t.left&&t.otherEvent.inResult)&&a.push(t);let i=!1;for(;!i;)for(i=!0,r=0,n=a.length;r<n;r++)r+1<n&&1===compareEvents(a[r],a[r+1])&&(o=a[r],a[r]=a[r+1],a[r+1]=o,i=!1);for(r=0,n=a.length;r<n;r++)(t=a[r]).pos=r;for(r=0,n=a.length;r<n;r++)(t=a[r]).left||(o=t.pos,t.pos=t.otherEvent.pos,t.otherEvent.pos=o);return a}function nextPos(e,t,r,n){let o,a,i=e+1;const s=t.length;for(o=t[e].point,i<s&&(a=t[i].point);i<s&&a[0]===o[0]&&a[1]===o[1];){if(!r[i])return i;a=t[++i].point}for(i=e-1;r[i]&&i>=n;)i--;return i}function connectEdges(e,t){let r,n;const o=orderEvents(e),a={},i=[];let s;for(r=0,n=o.length;r<n;r++){if(a[r])continue;const e=[[]];o[r].isExteriorRing?t===DIFFERENCE&&!o[r].isSubject&&i.length>1?i[i.length-1].push(e[0]):i.push(e):t!==DIFFERENCE||o[r].isSubject||0!==i.length?0===i.length?i.push([[e]]):i[i.length-1].push(e[0]):i.push(e);const n=i.length-1;let l=r;const u=o[r].point;for(e[0].push(u);l>=r;)s=o[l],a[l]=!0,s.left?(s.resultInOut=!1,s.contourId=n):(s.otherEvent.resultInOut=!0,s.otherEvent.contourId=n),a[l=s.pos]=!0,e[0].push(o[l].point),l=nextPos(l,o,a,r);s=o[l=-1===l?r:l],a[l]=a[s.pos]=!0,s.otherEvent.resultInOut=!0,s.otherEvent.contourId=n}return i}var tinyqueue=TinyQueue,default_1=TinyQueue;function TinyQueue(e,t){if(!(this instanceof TinyQueue))return new TinyQueue(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||defaultCompare,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function defaultCompare(e,t){return e<t?-1:e>t?1:0}TinyQueue.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,r=this.compare,n=t[e];e>0;){var o=e-1>>1,a=t[o];if(r(n,a)>=0)break;t[e]=a,e=o}t[e]=n},_down:function(e){for(var t=this.data,r=this.compare,n=this.length>>1,o=t[e];e<n;){var a=1+(e<<1),i=a+1,s=t[a];if(i<this.length&&r(t[i],s)<0&&(a=i,s=t[i]),r(s,o)>=0)break;t[e]=s,e=a}t[e]=o}},tinyqueue.default=default_1;const max=Math.max,min=Math.min;let contourId=0;function processPolygon(e,t,r,n,o,a){let i,s,l,u,c,g;for(i=0,s=e.length-1;i<s;i++){if(l=e[i],u=e[i+1],c=new SweepEvent(l,!1,void 0,t),g=new SweepEvent(u,!1,c,t),c.otherEvent=g,l[0]===u[0]&&l[1]===u[1])continue;c.contourId=g.contourId=r,a||(c.isExteriorRing=!1,g.isExteriorRing=!1),compareEvents(c,g)>0?g.left=!0:c.left=!0;const s=l[0],p=l[1];o[0]=min(o[0],s),o[1]=min(o[1],p),o[2]=max(o[2],s),o[3]=max(o[3],p),n.push(c),n.push(g)}}function fillQueue(e,t,r,n,o){const a=new tinyqueue(null,compareEvents);let i,s,l,u,c,g;for(l=0,u=e.length;l<u;l++)for(c=0,g=(i=e[l]).length;c<g;c++)(s=0===c)&&contourId++,processPolygon(i[c],!0,contourId,a,r,s);for(l=0,u=t.length;l<u;l++)for(c=0,g=(i=t[l]).length;c<g;c++)s=0===c,o===DIFFERENCE&&(s=!1),s&&contourId++,processPolygon(i[c],!1,contourId,a,n,s);return a}const EMPTY=[];function trivialOperation(e,t,r){let n=null;return e.length*t.length==0&&(r===INTERSECTION?n=EMPTY:r===DIFFERENCE?n=e:r!==UNION&&r!==XOR||(n=0===e.length?t:e)),n}function compareBBoxes(e,t,r,n,o){let a=null;return(r[0]>n[2]||n[0]>r[2]||r[1]>n[3]||n[1]>r[3])&&(o===INTERSECTION?a=EMPTY:o===DIFFERENCE?a=e:o!==UNION&&o!==XOR||(a=e.concat(t))),a}function boolean(e,t,r){"number"==typeof e[0][0][0]&&(e=[e]),"number"==typeof t[0][0][0]&&(t=[t]);let n=trivialOperation(e,t,r);if(n)return n===EMPTY?null:n;const o=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],i=fillQueue(e,t,o,a,r);return(n=compareBBoxes(e,t,o,a,r))?n===EMPTY?null:n:connectEdges(subdivide(i,e,t,o,a,r),r)}var inside=function(e,t){for(var r=e[0],n=e[1],o=!1,a=0,i=t.length-1;a<t.length;i=a++){var s=t[a][0],l=t[a][1],u=t[i][0],c=t[i][1];l>n!=c>n&&r<(u-s)*(n-l)/(c-l)+s&&(o=!o)}return o};function wayToPoint(e){if("Point"!==e.geometry.type){switch(e.properties.way_geometry=clone_1(e.geometry),e.geometry.type){case"Polygon":"function"==typeof area&&(e.properties.mesure=area(e.geometry));break;case"LineString":"function"==typeof length&&(e.properties.mesure=length(e))}e.geometry=pointOnFeature(e.geometry).geometry}}function wayIsRealyPolygon(e){if("no"===e.area)return!1;var t=Object.keys(e);return!(!t.includes("building")||"no"===e.building)||(!(!t.includes("landuse")||"no"===e.landuse)||(!(!t.includes("amenity")||"no"===e.amenity)||(!(!t.includes("leisure")||"no"===e.leisure)||(!(!t.includes("area")||"no"===e.area)||(!(!t.includes("place")||"no"===e.place)||(!(!t.includes("shop")||"no"===e.shop)||(!(!t.includes("boundary")||"no"===e.boundary)||(!(!t.includes("tourism")||"no"===e.tourism)||(!(!t.includes("historic")||"no"===e.historic)||(!(!t.includes("public_transport")||"no"===e.public_transport)||(!(!t.includes("office")||"no"===e.office)||(!(!t.includes("building:part")||"no"===e["building:part"])||(!(!t.includes("military")||"no"===e.military)||(!(!t.includes("ruins")||"no"===e.ruins)||(!(!t.includes("craft")||"no"===e.craft)||(!(!t.includes("golf")||"no"===e.golf)||(!(!t.includes("indoor")||"no"===e.indoor)||(!(!t.includes("highway")||!["services","rest_area","escape","elevator"].includes(e.highway))||(!(!t.includes("waterway")||!["riverbank","dock","boatyard","dam"].includes(e.waterway))||(!(!t.includes("barrier")||!["city_wall","ditch","hedge","retaining_wall","wall","spikes"].includes(e.barrier))||(!(!t.includes("railway")||!["station","turntable","roundhouse","platform"].includes(e.railway))||(!(!t.includes("power")||!["plant","substation","generator","transformer"].includes(e.power))||(!(!t.includes("natural")||["coastline","cliff","ridge","arete","tree_row"].includes(e.natural))||(!(!t.includes("man_made")||["cutline","embankment","pipeline"].includes(e.man_made))||!(!t.includes("aeroway")||["taxiway"].includes(e.aeroway))))))))))))))))))))))))))}function isFilteredByKeys(e,t){if(!t)return!0;if(!e)return!1;for(var r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];if(t.includes(o))return!0}return!1}function getPrimaryKeyOfObject(e,t){var r=e.properties.tags,n=Object.keys(t);for(var o in r)if(n.includes(o)){if(("way"==e.properties.type||"relation"==e.properties.type)&&t[o].exclude_way_values&&t[o].exclude_way_values.includes(r[o]))continue;return{k:o,v:r[o]}}return null}function getConfigTag(e,t){var r=getPrimaryKeyOfObject(e,t),n=t[r.k].values.filter((function(e){return e.tags[r.k]==[r.v]})),o=e.properties.tags,a={conf:void 0,matchProps:0},i=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var g=u.value,p=0;for(var h in g.tags)o[h]&&o[h]===g.tags[h]&&++p>a.matchProps&&(a={conf:g,matchProps:p})}}catch(e){s=!0,l=e}finally{try{i||null==c.return||c.return()}finally{if(s)throw l}}return a.conf?a.conf:null}function setIconStyle(e,t){var r,n=getConfigTag(e,t);return r="node"===e.properties.type?"circle":"LineString"===e.properties.way_geometry.type||"MultiLineString"===e.properties.way_geometry.type?"penta":"Polygon"===e.properties.way_geometry.type||"MultiPolygon"===e.properties.way_geometry.type?"square":"star",n?(e.properties.icon=n.icon?n.icon:"",e.properties.marker="".concat(r,"-").concat(n.markerColor,"-").concat(e.properties.icon),e.properties.hexColor=n.markerColor):(e.properties.icon="maki-circle",e.properties.hexColor="#000000",e.properties.marker="".concat(r,"-#000000-")),e}function addAttributesToFeature(e){e.properties.tags.name&&(e.properties._name=e.properties.tags.name),e.properties.meta.timestamp&&(e.properties.time=new Date(e.properties.meta.timestamp).getTime()),e.properties.tags.fixme&&(e.properties.fixme=!0)}function getMergedGeojsonGeojsonChanged(e,t){if(!t)return e;for(var r=[],n=0;n<t.features.length;n++)r.push(t.features[n].id);for(var o=e.features.length-1;o>=0;o--)r.includes(e.features[o].id)&&e.features.splice(o,1);return clone_1(e)}function mergeOldNewGeojsonData(e,t,r,n){var o=e.features,a=t.features;if(!o||0==o.length)return t;for(var i=[],s=0;s<o.length;s++)booleanPointInPolygon$1(o[s],r)&&i.push(o[s].id);for(var l=0;l<a.length;l++)for(var u=a[l].id,c=0;c<o.length;c++){if(u==o[c].id){o[c]=a[l],i.splice(i.indexOf(u),1);break}c==o.length-1&&o.push(a[l])}for(var g=0;g<i.length;g++)for(var p=i[g],h=0;h<o.length;h++)if(o[h].id==p){o.splice(h,1);break}return getMergedGeojsonGeojsonChanged(e,n)}function mergeBounds(e,t){return t&&0!==t.length?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:boolean(t.geometry.coordinates,e.geometry.coordinates,1)}}]}:{type:"FeatureCollection",features:[e]}}function unescapeXmlValue(e){return e.replace(/&amp;/g,"&").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}var convert=function(e,t){var r=null;t&&t.tagConfig&&(r=Object.keys(t.tagConfig));var n=parser.parse(e,{attributeNamePrefix:"",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!1,ignoreNameSpace:!1,allowBooleanAttributes:!0,parseNodeValue:!1,parseAttributeValue:!1,trimValues:!1,cdataTagName:!1,cdataPositionChar:"\\c",attrValueProcessor:function(e){return unescapeXmlValue(e)},tagValueProcessor:function(e){return unescapeXmlValue(e)}}).osm,o={minlat:Number(n.bounds.minlat),minlon:Number(n.bounds.minlon),maxlat:Number(n.bounds.maxlat),maxlon:Number(n.bounds.maxlon)},a=[o.minlon,o.minlat,o.maxlon,o.maxlat],i=function(e){Array.isArray(e)||(e=[e]);for(var t={},r=0;r<e.length;r++)t[e[r].k]=e[r].v;return t},s=function(e,t){for(var r=e[0]==e[e.length-1]?"Polygon":"LineString",n=[],o=0;o<e.length;o++){var a="node/".concat(e[o]);t[a]?n.push(t[a].geometry.coordinates):console.log("TAINDED!")}return"LineString"==r?{type:"LineString",coordinates:n}:"Polygon"==r?{type:"Polygon",coordinates:[n]}:void 0},l=function(e,t,r){var n=clone_1(e),o=Array.isArray(n.member)?n.member:[n.member];n.tainted=!1;for(var a=0;a<o.length;a++){var i=o[a],s="way/".concat(i.ref);if(t[s]){var l=t[s].geometry,c=void 0;"LineString"===l.type?(i.typeGeom="LineString",c=clone_1(l.coordinates)):"Polygon"===l.type&&(i.typeGeom="Polygon",c=clone_1(l.coordinates[0])),i.ring=c}else i.ring=null,n.tainted=!0}if(n.tainted)return null;Array.isArray(o)||(o=[o]);var g=o.filter((function(e){return"outer"===e.role&&"Polygon"===e.typeGeom&&e.ring})),p=o.filter((function(e){return"inner"===e.role&&"Polygon"===e.typeGeom&&e.ring})),h=o.filter((function(e){return"outer"===e.role&&"LineString"===e.typeGeom&&e.ring})),f=o.filter((function(e){return"inner"===e.role&&"LineString"===e.typeGeom&&e.ring}));if(0===g.length&&0===h.length)return null;if(h.length>0){var d=u(h.map((function(e){return e.ring}))),y=!0,m=!1,b=void 0;try{for(var v,_=d[Symbol.iterator]();!(y=(v=_.next()).done);y=!0){var T=v.value;g.push({type:"way",ref:"",role:"outer",typeGeom:"Polygon",ring:T})}}catch(e){m=!0,b=e}finally{try{y||null==_.return||_.return()}finally{if(m)throw b}}}if(f.length>0){var w=u(f.map((function(e){return e.ring}))),A=!0,E=!1,S=void 0;try{for(var j,P=w[Symbol.iterator]();!(A=(j=P.next()).done);A=!0){var C=j.value;p.push({type:"way",ref:"",role:"inner",typeGeom:"Polygon",ring:C})}}catch(e){E=!0,S=e}finally{try{A||null==P.return||P.return()}finally{if(E)throw S}}}if(1==g.length){var O=[g[0].ring],N=!0,x=!1,I=void 0;try{for(var $,M=p[Symbol.iterator]();!(N=($=M.next()).done);N=!0){var k=$.value;O.push(k.ring)}}catch(e){x=!0,I=e}finally{try{N||null==M.return||M.return()}finally{if(x)throw I}}return{type:"Polygon",coordinates:O}}var R=g.map((function(e){return[e.ring]})),F=!0,L=!1,D=void 0;try{for(var G,V=p[Symbol.iterator]();!(F=(G=V.next()).done);F=!0)for(var B=G.value,q=0;q<R.length;q++){var U=R[q][0],K=B.ring[0];inside(K,U)&&R[q].push(B.ring)}}catch(e){L=!0,D=e}finally{try{F||null==V.return||V.return()}finally{if(L)throw D}}return{type:"MultiPolygon",coordinates:R}},u=function(e){var t=[],r=e[0].slice();e.splice(0,1);for(var n=r[0].toString(),o=r[r.length-1].toString(),a=0;0!=e.length&&a<e.length;)e[a][0].toString()==o?(e[a].splice(0,1),r=[].concat(_toConsumableArray(r),_toConsumableArray(e[a])),e.splice(a,1),n=r[0].toString(),o=r[r.length-1].toString(),a=0):e[a][e[a].length-1].toString()==n?(e[a].splice(e[a].length-1,1),r=[].concat(_toConsumableArray(e[a]),_toConsumableArray(r)),e.splice(a,1),n=r[0].toString(),o=r[r.length-1].toString(),a=0):e[a][0].toString()==n?(e[a].splice(0,1),r=[].concat(_toConsumableArray(e[a].reverse()),_toConsumableArray(r)),e.splice(a,1),n=r[0].toString(),o=r[r.length-1].toString(),a=0):e[a][e[a].length-1].toString()==o?(e[a].splice(e[a].length-1,1),r=[].concat(_toConsumableArray(r),_toConsumableArray(e[a].reverse())),e.splice(a,1),n=r[0].toString(),o=r[r.length-1].toString(),a=0):a++,n==o&&(t.push(r),e.length>0&&(r=e[0].slice(),e.splice(0,1),n=r[0].toString(),o=r[r.length-1].toString(),a=0));return t},c={};Array.isArray(n.node)||(n.node=n.node?[n.node]:[]);var g=!0,p=!1,h=void 0;try{for(var f,d=n.node[Symbol.iterator]();!(g=(f=d.next()).done);g=!0){var y=f.value,m="node/".concat(y.id),b={type:"Feature",id:"node/".concat(y.id),properties:{type:"node",id:y.id,meta:{timestamp:y.timestamp,version:y.version,changeset:y.changeset,user:y.user,uid:y.uid}},geometry:{type:"Point",coordinates:[Number(y.lon),Number(y.lat)]}};y.tag&&(b.properties.tags=i(y.tag)),c[m]=b}}catch(e){p=!0,h=e}finally{try{g||null==d.return||d.return()}finally{if(p)throw h}}Array.isArray(n.way)||(n.way=n.way?[n.way]:[]);var v={},_=!0,T=!1,w=void 0;try{for(var A,E=n.way[Symbol.iterator]();!(_=(A=E.next()).done);_=!0){var S=A.value,j="way/".concat(S.id),P={type:"Feature",id:"way/".concat(S.id),properties:{type:"way",id:S.id,meta:{timestamp:S.timestamp,version:S.version,changeset:S.changeset,user:S.user,uid:S.uid}}};if(S.tag&&(P.properties.tags=i(S.tag)),S.nd){var C=[],O=!0,N=!1,x=void 0;try{for(var I,$=S.nd[Symbol.iterator]();!(O=(I=$.next()).done);O=!0){var M=I.value.ref;C.push(M);var k=c["node/".concat(M)];k&&(k.properties.usedByWays||(k.properties.usedByWays=[]),k.properties.usedByWays.push("way/".concat(S.id)))}}catch(e){N=!0,x=e}finally{try{O||null==$.return||$.return()}finally{if(N)throw x}}P.ndRefs=C,P.geometry=s(C,c)}v[j]=P}}catch(e){T=!0,w=e}finally{try{_||null==E.return||E.return()}finally{if(T)throw w}}var R={};Array.isArray(n.relation)||(n.relation=n.relation?[n.relation]:[]);var F=!0,L=!1,D=void 0;try{for(var G,V=n.relation[Symbol.iterator]();!(F=(G=V.next()).done);F=!0){var B=G.value,q="".concat(B.id),U={type:"Feature",id:"".concat(B.id),properties:{type:"relation",id:B.id,meta:{timestamp:B.timestamp,version:B.version,changeset:B.changeset,user:B.user,uid:B.uid}},member:B.member,tainted:!1};B.tag&&(U.properties.tags=i(B.tag)),Array.isArray(B.member)||(B.member=[B.member]);var K=!0,H=!1,J=void 0;try{for(var z,W=B.member[Symbol.iterator]();!(K=(z=W.next()).done);K=!0){var X=z.value,Q="".concat(X.type,"/").concat(X.ref),Y="node"==X.type?c:v;Y[Q]?(Y[Q].properties.relations||(Y[Q].properties.relations=[]),Y[Q].properties.relations.push({rel:U.id,reltags:U.properties.tags,role:X.role})):U.tainted=!0}}catch(e){H=!0,J=e}finally{try{K||null==W.return||W.return()}finally{if(H)throw J}}R[q]=U}}catch(e){L=!0,D=e}finally{try{F||null==V.return||V.return()}finally{if(L)throw D}}for(var Z in R){var ee=R[Z];if("multipolygon"===ee.properties.tags.type){var te=l(ee,v);te&&(ee.geometry=te)}}var re=[];for(var ne in c){var oe=c[ne].properties.tags;if(c[ne].geometry&&c[ne].properties.tags&&isFilteredByKeys(oe,r))if(addAttributesToFeature(c[ne]),t&&t.tagConfig){var ae=getPrimaryKeyOfObject(c[ne],t.tagConfig);ae&&(c[ne].properties.primaryTag=ae,setIconStyle(c[ne],t.tagConfig),re.push(c[ne]))}else re.push(c[ne])}for(var ie in v){var se=v[ie].properties.tags;if(v[ie].geometry&&v[ie].properties.tags&&isFilteredByKeys(se,r))if(addAttributesToFeature(v[ie]),"Polygon"!=v[ie].geometry.type&&"MultiPolygon"!=v[ie].geometry.type||wayIsRealyPolygon(v[ie].properties.tags)||(v[ie].geometry.coordinates=v[ie].geometry.coordinates[0],v[ie].geometry.type="Polygon"==v[ie].geometry.type?"LineString":"MultiLineString"),wayToPoint(v[ie]),t&&t.tagConfig){var le=getPrimaryKeyOfObject(v[ie],t.tagConfig);le&&(v[ie].properties.primaryTag=le,setIconStyle(v[ie],t.tagConfig),re.push(v[ie]))}else re.push(v[ie])}for(var ue in R){var ce=R[ue].properties.tags;if(R[ue].geometry&&R[ue].properties.tags&&isFilteredByKeys(ce,r))if(addAttributesToFeature(R[ue]),"Polygon"!=R[ue].geometry.type&&"MultiPolygon"!=R[ue].geometry.type||wayIsRealyPolygon(R[ue].properties.tags)||(R[ue].geometry.coordinates=R[ue].geometry.coordinates[0],R[ue].geometry.type="Polygon"==R[ue].geometry.type?"LineString":"MultiLineString"),wayToPoint(R[ue]),t&&t.tagConfig){var ge=getPrimaryKeyOfObject(R[ue],t.tagConfig);ge&&(R[ue].properties.primaryTag=ge,setIconStyle(R[ue],t.tagConfig),re.push(R[ue]))}else re.push(R[ue])}var pe={type:"FeatureCollection",features:re};if(t&&t.oldGeojson&&t.geojsonChanged){var he=bboxPolygon(a);return{geojson:mergeOldNewGeojsonData(t.oldGeojson,pe,he,t.geojsonChanged),geojsonBbox:mergeBounds(he,t.oldBboxFeature)}}return{geojson:pe,geojsonBbox:null}};exports.convert=convert,exports.getConfigTag=getConfigTag,exports.setIconStyle=setIconStyle;
