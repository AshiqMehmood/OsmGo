var osmToOsmgo=function(){"use strict";function e(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t){return e(t={exports:{}},t.exports),t.exports}var o=n((function(e,t){const r=function(e,t){const r=t.exec(e);return!(null==r)};t.isExist=function(e){return void 0!==e},t.isEmptyObject=function(e){return 0===Object.keys(e).length},t.merge=function(e,t){if(t){const r=Object.keys(t),n=r.length;for(let o=0;o<n;o++)e[r[o]]=t[r[o]]}},t.getValue=function(e){return t.isExist(e)?e:""},t.buildOptions=function(e,t,r){var n={};if(!e)return t;for(let o=0;o<r.length;o++)void 0!==e[r[o]]?n[r[o]]=e[r[o]]:n[r[o]]=t[r[o]];return n},t.doesMatch=r,t.doesNotMatch=function(e,t){return!r(e,t)},t.getAllMatches=function(e,t){const r=[];let n=t.exec(e);for(;n;){const o=[],i=n.length;for(let e=0;e<i;e++)o.push(n[e]);r.push(o),n=t.exec(e)}return r}}));o.isExist,o.isEmptyObject,o.merge,o.getValue,o.buildOptions,o.doesMatch,o.doesNotMatch,o.getAllMatches;const i=function(e,t){const r={};if(!(e.child&&!o.isEmptyObject(e.child)||e.attrsMap&&!o.isEmptyObject(e.attrsMap)))return o.isExist(e.val)?e.val:"";o.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==t.cdataPositionChar)&&(r[t.textNodeName]=e.val),o.merge(r,e.attrsMap);const n=Object.keys(e.child);for(let o=0;o<n.length;o++){var a=n[o];if(e.child[a]&&e.child[a].length>1)for(var s in r[a]=[],e.child[a])r[a].push(i(e.child[a][s],t));else r[a]=i(e.child[a][0],t)}return r};var a={convertToJson:i},s=function(e,t,r){this.tagname=e,this.parent=t,this.child={},this.attrsMap={},this.val=r,this.addChild=function(e){Array.isArray(this.child[e.tagname])?this.child[e.tagname].push(e):this.child[e.tagname]=[e]}};const u=o.buildOptions,l={OPENING:1,CLOSING:2,SELF:3,CDATA:4};let c="<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|(([\\w:\\-._]*:)?([\\w:\\-._]+))([^>]*)>|((\\/)(([\\w:\\-._]*:)?([\\w:\\-._]+))\\s*>))([^<]*)";!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const f={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",localeRange:"",tagValueProcessor:function(e){return e},attrValueProcessor:function(e){return e},stopNodes:[]};var h=f;const d=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","localeRange","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","stopNodes"];var g=d;function p(e,t){return e&&(t.trimValues&&(e=e.trim()),e=v(e=t.tagValueProcessor(e),t.parseNodeValue,t.parseTrueNumberOnly)),e}function y(e){return"]]>"===e[4]?l.CDATA:"/"===e[10]?l.CLOSING:void 0!==e[8]&&"/"===e[8].substr(e[8].length-1)?l.SELF:l.OPENING}function m(e,t){if(t.ignoreNameSpace){const t=e.split(":"),r="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=r+t[1])}return e}function v(e,t,r){if(t&&"string"==typeof e){let t;return""===e.trim()||isNaN(e)?t="true"===e||"false"!==e&&e:(t=-1!==e.indexOf("0x")?Number.parseInt(e,16):-1!==e.indexOf(".")?Number.parseFloat(e):Number.parseInt(e,10),r&&(t=String(t)===e?t:e)),t}return o.isExist(e)?e:""}const b=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function w(e,t){if(!t.ignoreAttributes&&"string"==typeof e){e=e.replace(/\r?\n/g," ");const r=o.getAllMatches(e,b),n=r.length,i={};for(let e=0;e<n;e++){const n=m(r[e][1],t);n.length&&(void 0!==r[e][4]?(t.trimValues&&(r[e][4]=r[e][4].trim()),r[e][4]=t.attrValueProcessor(r[e][4]),i[t.attributeNamePrefix+n]=v(r[e][4],t.parseAttributeValue,t.parseTrueNumberOnly)):t.allowBooleanAttributes&&(i[t.attributeNamePrefix+n]=!0))}if(!Object.keys(i).length)return;if(t.attrNodeName){const e={};return e[t.attrNodeName]=i,e}return i}}var E={defaultOptions:h,props:g,getTraversalObj:function(e,t){t=u(t,f,d),e=e.replace(/<!--[\s\S]*?-->/g,"");const r=new s("!xml");let n=r;c=c.replace(/\[\\w/g,"["+t.localeRange+"\\w");const i=new RegExp(c,"g");let a=i.exec(e),h=i.exec(e);for(;a;){const r=y(a);if(r===l.CLOSING)n.parent&&a[14]&&(n.parent.val=o.getValue(n.parent.val)+""+p(a[14],t)),t.stopNodes.length&&t.stopNodes.includes(n.tagname)&&(n.child=[],null==n.attrsMap&&(n.attrsMap={}),n.val=e.substr(n.startIndex+1,a.index-n.startIndex-1)),n=n.parent;else if(r===l.CDATA)if(t.cdataTagName){const e=new s(t.cdataTagName,n,a[3]);e.attrsMap=w(a[8],t),n.addChild(e),n.val=o.getValue(n.val)+t.cdataPositionChar,a[14]&&(n.val+=p(a[14],t))}else n.val=(n.val||"")+(a[3]||"")+p(a[14],t);else if(r===l.SELF){n&&a[14]&&(n.val=o.getValue(n.val)+""+p(a[14],t));const e=new s(t.ignoreNameSpace?a[7]:a[5],n,"");a[8]&&a[8].length>0&&(a[8]=a[8].substr(0,a[8].length-1)),e.attrsMap=w(a[8],t),n.addChild(e)}else{const e=new s(t.ignoreNameSpace?a[7]:a[5],n,p(a[14],t));t.stopNodes.length&&t.stopNodes.includes(e.tagname)&&(e.startIndex=a.index+a[1].length),e.attrsMap=w(a[8],t),n.addChild(e),n=e}a=h,h=i.exec(e)}return r}};const j=function(e){return String.fromCharCode(e)},P={nilChar:j(176),missingChar:j(201),nilPremitive:j(175),missingPremitive:j(200),emptyChar:j(178),emptyValue:j(177),boundryChar:j(179),objStart:j(198),arrStart:j(204),arrayEnd:j(185)},A=[P.nilChar,P.nilPremitive,P.missingChar,P.missingPremitive,P.boundryChar,P.emptyChar,P.emptyValue,P.arrayEnd,P.objStart,P.arrStart],x=function(e,t,r){if("string"==typeof t)return e&&e[0]&&void 0!==e[0].val?_(e[0].val):_(e);{const o=void 0===(n=e)?P.missingChar:null===n?P.nilChar:!(n.child&&0===Object.keys(n.child).length&&(!n.attrsMap||0===Object.keys(n.attrsMap).length))||P.emptyChar;if(!0===o){let n="";if(Array.isArray(t)){n+=P.arrStart;const o=t[0],i=e.length;if("string"==typeof o)for(let t=0;t<i;t++){const r=_(e[t].val);n=O(n,r)}else for(let t=0;t<i;t++){const i=x(e[t],o,r);n=O(n,i)}n+=P.arrayEnd}else{n+=P.objStart;const o=Object.keys(t);Array.isArray(e)&&(e=e[0]);for(let i in o){const a=o[i];let s;s=!r.ignoreAttributes&&e.attrsMap&&e.attrsMap[a]?x(e.attrsMap[a],t[a],r):a===r.textNodeName?x(e.val,t[a],r):x(e.child[a],t[a],r),n=O(n,s)}}return n}return o}var n},_=function(e){switch(e){case void 0:return P.missingPremitive;case null:return P.nilPremitive;case"":return P.emptyValue;default:return e}},O=function(e,t){return S(t[0])||S(e[e.length-1])||(e+=P.boundryChar),e+t},S=function(e){return-1!==A.indexOf(e)};const N=o.buildOptions;var T={convert2nimn:function(e,t,r){return r=N(r,E.defaultOptions,E.props),x(e,t,r)}};const M=o.buildOptions,k=function(e,t,r){let n="{";const i=Object.keys(e.child);for(let r=0;r<i.length;r++){var a=i[r];if(e.child[a]&&e.child[a].length>1){for(var s in n+='"'+a+'" : [ ',e.child[a])n+=k(e.child[a][s],t)+" , ";n=n.substr(0,n.length-1)+" ] "}else n+='"'+a+'" : '+k(e.child[a][0],t)+" ,"}return o.merge(n,e.attrsMap),o.isEmptyObject(n)?o.isExist(e.val)?e.val:"":(o.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==t.cdataPositionChar)&&(n+='"'+t.textNodeName+'" : '+(!0!==(u=e.val)&&!1!==u&&isNaN(u)?'"'+u+'"':u)),","===n[n.length-1]&&(n=n.substr(0,n.length-2)),n+"}");var u};var C={convertToJsonString:function(e,t){return(t=M(t,E.defaultOptions,E.props)).indentBy=t.indentBy||"",k(e,t)}};const R={allowBooleanAttributes:!1,localeRange:"a-zA-Z"},I=["allowBooleanAttributes","localeRange"];function L(e,t){for(var r=t;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{var n=e.substr(r,t-r);if(t>5&&"xml"===n)return{err:{code:"InvalidXml",msg:"XML declaration allowed only at the start of the document."}};if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function F(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let r=1;for(t+=8;t<e.length;t++)if("<"===e[t])r++;else if(">"===e[t]&&0===--r)break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}var D='"',B="'";function V(e,t){let r="",n="";for(;t<e.length;t++){if(e[t]===D||e[t]===B)if(""===n)n=e[t];else{if(n!==e[t])continue;n=""}else if(">"===e[t]&&""===n)break;r+=e[t]}return""===n&&{value:r,index:t}}const q=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function G(e,t,r){const n=o.getAllMatches(e,q),i={};for(let e=0;e<n.length;e++){if(0===n[e][1].length)return{err:{code:"InvalidAttr",msg:"attribute "+n[e][2]+" has no space in starting."}};if(void 0===n[e][3]&&!t.allowBooleanAttributes)return{err:{code:"InvalidAttr",msg:"boolean attribute "+n[e][2]+" is not allowed."}};const o=n[e][2];if(!z(o,r))return{err:{code:"InvalidAttr",msg:"attribute "+o+" is an invalid name."}};if(i.hasOwnProperty(o))return{err:{code:"InvalidAttr",msg:"attribute "+o+" is repeated."}};i[o]=1}return!0}function z(e,t){return o.doesMatch(e,t)}function U(e,t){return!o.doesNotMatch(e,t)}var J=function(e,t){t=o.buildOptions(t,R,I);const r=[];let n=!1;"\ufeff"===e[0]&&(e=e.substr(1));const i=new RegExp("^[_w][\\w\\-.:]*$".replace("_w","_"+t.localeRange)),a=new RegExp("^([w]|_)[\\w.\\-_:]*".replace("([w","(["+t.localeRange));for(let o=0;o<e.length;o++){if("<"!==e[o]){if(" "===e[o]||"\t"===e[o]||"\n"===e[o]||"\r"===e[o])continue;return{err:{code:"InvalidChar",msg:"char "+e[o]+" is not expected ."}}}if("?"===e[++o]){if((o=L(e,++o)).err)return o}else{if("!"===e[o]){o=F(e,o);continue}{let s=!1;"/"===e[o]&&(s=!0,o++);let u="";for(;o<e.length&&">"!==e[o]&&" "!==e[o]&&"\t"!==e[o]&&"\n"!==e[o]&&"\r"!==e[o];o++)u+=e[o];if("/"===(u=u.trim())[u.length-1]){u=u.substring(0,u.length-1);continue}if(!U(u,a))return{err:{code:"InvalidTag",msg:"Tag "+u+" is an invalid name."}};const l=V(e,o);if(!1===l)return{err:{code:"InvalidAttr",msg:"Attributes for "+u+" have open quote"}};let c=l.value;if(o=l.index,"/"===c[c.length-1]){const e=G(c=c.substring(0,c.length-1),t,i);if(!0!==e)return e;n=!0}else if(s){if(c.trim().length>0)return{err:{code:"InvalidTag",msg:"closing tag "+u+" can't have attributes or invalid starting."}};{const e=r.pop();if(u!==e)return{err:{code:"InvalidTag",msg:"closing tag "+e+" is expected inplace of "+u+"."}}}}else{const e=G(c,t,i);if(!0!==e)return e;r.push(u),n=!0}for(o++;o<e.length;o++)if("<"===e[o]){if("!"===e[o+1]){o=F(e,++o);continue}break}"<"===e[o]&&o--}}}return n?!(r.length>0)||{err:{code:"InvalidXml",msg:"Invalid "+JSON.stringify(r,null,4).replace(/\r?\n/g,"")+" found."}}:{err:{code:"InvalidXml",msg:"Start tag expected."}}};const $=o.buildOptions,W={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(e){return e},attrValueProcessor:function(e){return e}},X=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor"];function Y(e){this.options=$(e,W,X),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=ne),this.options.cdataTagName?this.isCDATA=oe:this.isCDATA=function(){return!1},this.replaceCDATAstr=Z,this.replaceCDATAarr=H,this.options.format?(this.indentate=re,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=te,this.buildObjNode=Q):(this.buildTextNode=ee,this.buildObjNode=K),this.buildTextValNode=ee,this.buildObjectNode=K}function Z(e,t){return e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e?e+"<![CDATA["+t+"]]"+this.tagEndChar:e.replace(this.options.cdataPositionChar,"<![CDATA["+t+"]]"+this.tagEndChar)}function H(e,t){if(e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e)return e+"<![CDATA["+t.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(let r in t)e=e.replace(this.options.cdataPositionChar,"<![CDATA["+t[r]+"]]>");return e+this.newLine}function K(e,t,r,n){return r&&!e.includes("<")?this.indentate(n)+"<"+t+r+">"+e+"</"+t+this.tagEndChar:this.indentate(n)+"<"+t+r+this.tagEndChar+e+this.indentate(n)+"</"+t+this.tagEndChar}function Q(e,t,r,n){return""!==e?this.buildObjectNode(e,t,r,n):this.indentate(n)+"<"+t+r+"/"+this.tagEndChar}function ee(e,t,r,n){return this.indentate(n)+"<"+t+r+">"+this.options.tagValueProcessor(e)+"</"+t+this.tagEndChar}function te(e,t,r,n){return""!==e?this.buildTextValNode(e,t,r,n):this.indentate(n)+"<"+t+r+"/"+this.tagEndChar}function re(e){return this.options.indentBy.repeat(e)}function ne(e){return!!e.startsWith(this.options.attributeNamePrefix)&&e.substr(this.attrPrefixLen)}function oe(e){return e===this.options.cdataTagName}Y.prototype.parse=function(e){return this.j2x(e,0).val},Y.prototype.j2x=function(e,t){let r="",n="";const o=Object.keys(e),i=o.length;for(let a=0;a<i;a++){const i=o[a];if(void 0===e[i]);else if(null===e[i])n+=this.indentate(t)+"<"+i+"/"+this.tagEndChar;else if(e[i]instanceof Date)n+=this.buildTextNode(e[i],i,"",t);else if("object"!=typeof e[i]){const o=this.isAttribute(i);o?r+=" "+o+'="'+this.options.attrValueProcessor(""+e[i])+'"':this.isCDATA(i)?e[this.options.textNodeName]?n+=this.replaceCDATAstr(e[this.options.textNodeName],e[i]):n+=this.replaceCDATAstr("",e[i]):i===this.options.textNodeName?e[this.options.cdataTagName]||(n+=this.options.tagValueProcessor(""+e[i])):n+=this.buildTextNode(e[i],i,"",t)}else if(Array.isArray(e[i]))if(this.isCDATA(i))n+=this.indentate(t),e[this.options.textNodeName]?n+=this.replaceCDATAarr(e[this.options.textNodeName],e[i]):n+=this.replaceCDATAarr("",e[i]);else{const r=e[i].length;for(let o=0;o<r;o++){const r=e[i][o];if(void 0===r);else if(null===r)n+=this.indentate(t)+"<"+i+"/"+this.tagEndChar;else if("object"==typeof r){const e=this.j2x(r,t+1);n+=this.buildObjNode(e.val,i,e.attrStr,t)}else n+=this.buildTextNode(r,i,"",t)}}else if(this.options.attrNodeName&&i===this.options.attrNodeName){const t=Object.keys(e[i]),n=t.length;for(let o=0;o<n;o++)r+=" "+t[o]+'="'+this.options.attrValueProcessor(""+e[i][t[o]])+'"'}else{const r=this.j2x(e[i],t+1);n+=this.buildObjNode(r.val,i,r.attrStr,t)}}return{attrStr:r,val:n}};var ie=Y,ae=n((function(e,t){const r=E,n=o.buildOptions;t.parse=function(e,t){return t=n(t,r.defaultOptions,r.props),a.convertToJson(E.getTraversalObj(e,t),t)},t.convertTonimn=T.convert2nimn,t.getTraversalObj=E.getTraversalObj,t.convertToJson=a.convertToJson,t.convertToJsonString=C.convertToJsonString,t.validate=J,t.j2xParser=ie,t.parseToNimn=function(e,r,n){return t.convertTonimn(t.getTraversalObj(e,n),r,n)}})),se=(ae.parse,ae.convertTonimn,ae.getTraversalObj,ae.convertToJson,ae.convertToJsonString,ae.validate,ae.j2xParser,ae.parseToNimn,{meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325});function ue(e,t,r){if(!de(r=r||{}))throw new Error("options is invalid");var n=r.bbox,o=r.id;if(void 0===e)throw new Error("geometry is required");if(t&&t.constructor!==Object)throw new Error("properties must be an Object");n&&ge(n),o&&pe(o);var i={type:"Feature"};return o&&(i.id=o),n&&(i.bbox=n),i.properties=t||{},i.geometry=e,i}function le(e,t,r){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!he(e[0])||!he(e[1]))throw new Error("coordinates must contain numbers");return ue({type:"Point",coordinates:e},t,r)}function ce(e,t){if(!de(t=t||{}))throw new Error("options is invalid");var r=t.bbox,n=t.id;if(!e)throw new Error("No features passed");if(!Array.isArray(e))throw new Error("features must be an Array");r&&ge(r),n&&pe(n);var o={type:"FeatureCollection"};return n&&(o.id=n),r&&(o.bbox=r),o.features=e,o}function fe(e){if(null==e)throw new Error("degrees is required");return e%360*Math.PI/180}function he(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}function de(e){return!!e&&e.constructor===Object}function ge(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!he(e))throw new Error("bbox must only contain numbers")}))}function pe(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}function ye(e,t,r){if(null!==e)for(var n,o,i,a,s,u,l,c,f=0,h=0,d=e.type,g="FeatureCollection"===d,p="Feature"===d,y=g?e.features.length:1,m=0;m<y;m++){s=(c=!!(l=g?e.features[m].geometry:p?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var v=0;v<s;v++){var b=0,w=0;if(null!==(a=c?l.geometries[v]:l)){u=a.coordinates;var E=a.type;switch(f=!r||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case"Point":if(!1===t(u,h,m,b,w))return!1;h++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===t(u[n],h,m,b,w))return!1;h++,"MultiPoint"===E&&b++}"LineString"===E&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-f;o++){if(!1===t(u[n][o],h,m,b,w))return!1;h++}"MultiLineString"===E&&b++,"Polygon"===E&&w++}"Polygon"===E&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for("MultiPolygon"===E&&(w=0),o=0;o<u[n].length;o++){for(i=0;i<u[n][o].length-f;i++){if(!1===t(u[n][o][i],h,m,b,w))return!1;h++}w++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===ye(a.geometries[n],t,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function me(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function ve(e){var t=[];return"FeatureCollection"===e.type?me(e,(function(e){ye(e,(function(r){t.push(le(r,e.properties))}))})):ye(e,(function(r){t.push(le(r,e.properties))})),ce(t)}function be(e,t){if(!de(t=t||{}))throw new Error("options is invalid");var r=t.properties;if(!e)throw new Error("geojson is required");var n=function(e){var t=[1/0,1/0,-1/0,-1/0];return ye(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}(e);return le([(n[0]+n[2])/2,(n[1]+n[3])/2],r)}function we(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return Ee(e);case"FeatureCollection":return function(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach((function(r){switch(r){case"type":case"features":return;default:t[r]=e[r]}})),t.features=e.features.map((function(e){return Ee(e)})),t}(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return je(e);default:throw new Error("unknown GeoJSON type")}}function Ee(e){var t={type:"Feature"};return Object.keys(e).forEach((function(r){switch(r){case"type":case"properties":case"geometry":return;default:t[r]=e[r]}})),t.properties=function e(t){var r={};if(!t)return r;Object.keys(t).forEach((function(n){var o=t[n];"object"==typeof o?null===o?r[n]=null:o.length?r[n]=o.map((function(e){return e})):r[n]=e(o):r[n]=o}));return r}(e.properties),t.geometry=je(e.geometry),t}function je(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?(t.geometries=e.geometries.map((function(e){return je(e)})),t):(t.coordinates=function e(t){if("object"!=typeof t[0])return t.slice();return t.map((function(t){return e(t)}))}(e.coordinates),t)}function Pe(e){if(!e)throw new Error("coord is required");if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates;if(Array.isArray(e)&&e.length>=2&&void 0===e[0].length&&void 0===e[1].length)return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ae(e,t,r){if(!de(r=r||{}))throw new Error("options is invalid");var n=r.units,o=Pe(e),i=Pe(t),a=fe(i[1]-o[1]),s=fe(i[0]-o[0]),u=fe(o[1]),l=fe(i[1]),c=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(u)*Math.cos(l);return function(e,t){if(null==e)throw new Error("radians is required");if(t&&"string"!=typeof t)throw new Error("units must be a string");var r=se[t||"kilometers"];if(!r)throw new Error(t+" units is invalid");return e*r}(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),n)}function xe(e,t,r){if("object"!=typeof(r=r||{}))throw new Error("options is invalid");var n=r.ignoreBoundary;if(!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var o=Pe(e),i=function(e){if(!e)throw new Error("coords is required");if("Feature"===e.type&&null!==e.geometry)return e.geometry.coordinates;if(e.coordinates)return e.coordinates;if(Array.isArray(e))return e;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(t),a=t.geometry?t.geometry.type:t.type,s=t.bbox;if(s&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(o,s))return!1;"Polygon"===a&&(i=[i]);for(var u=0,l=!1;u<i.length&&!l;u++)if(_e(o,i[u][0],n)){for(var c=!1,f=1;f<i[u].length&&!c;)_e(o,i[u][f],!n)&&(c=!0),f++;c||(l=!0)}return l}function _e(e,t,r){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,i=t.length-1;o<t.length;i=o++){var a=t[o][0],s=t[o][1],u=t[i][0],l=t[i][1];if(e[1]*(a-u)+s*(u-e[0])+l*(e[0]-a)==0&&(a-e[0])*(u-e[0])<=0&&(s-e[1])*(l-e[1])<=0)return!r;s>e[1]!=l>e[1]&&e[0]<(u-a)*(e[1]-s)/(l-s)+a&&(n=!n)}return n}function Oe(e){for(var t=function(e){if("FeatureCollection"!==e.type)return"Feature"!==e.type?ce([ue(e)]):ce([e]);return e}(e),r=be(t),n=!1,o=0;!n&&o<t.features.length;){var i,a=t.features[o].geometry,s=!1;if("Point"===a.type)r.geometry.coordinates[0]===a.coordinates[0]&&r.geometry.coordinates[1]===a.coordinates[1]&&(n=!0);else if("MultiPoint"===a.type){var u=!1;for(i=0;!u&&i<a.coordinates.length;)r.geometry.coordinates[0]===a.coordinates[i][0]&&r.geometry.coordinates[1]===a.coordinates[i][1]&&(n=!0,u=!0),i++}else if("LineString"===a.type)for(i=0;!s&&i<a.coordinates.length-1;)Se(r.geometry.coordinates[0],r.geometry.coordinates[1],a.coordinates[i][0],a.coordinates[i][1],a.coordinates[i+1][0],a.coordinates[i+1][1])&&(s=!0,n=!0),i++;else if("MultiLineString"===a.type)for(var l=0;l<a.coordinates.length;){s=!1,i=0;for(var c=a.coordinates[l];!s&&i<c.length-1;)Se(r.geometry.coordinates[0],r.geometry.coordinates[1],c[i][0],c[i][1],c[i+1][0],c[i+1][1])&&(s=!0,n=!0),i++;l++}else"Polygon"!==a.type&&"MultiPolygon"!==a.type||xe(r,a)&&(n=!0);o++}if(n)return r;var f=ce([]);for(o=0;o<t.features.length;o++)f.features=f.features.concat(ve(t.features[o]).features);return le(function(e,t){if(!e)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var r,n=1/0;return me(t,(function(t,o){var i=Ae(e,t);i<n&&((r=we(t)).properties.featureIndex=o,r.properties.distanceToPoint=i,n=i)})),r}(r,f).geometry.coordinates)}function Se(e,t,r,n,o,i){return Math.sqrt((o-r)*(o-r)+(i-n)*(i-n))===Math.sqrt((e-r)*(e-r)+(t-n)*(t-n))+Math.sqrt((o-e)*(o-e)+(i-t)*(i-t))}var Ne=n((function(e,t){function r(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function n(e,t,n){return void 0===n&&(n={}),r({type:"Point",coordinates:e},t,n)}function o(e,t,n){void 0===n&&(n={});for(var o=0,i=e;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,n)}function i(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,n)}function a(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function s(e,t,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:e},t,n)}function u(e,t,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:e},t,n)}function l(e,t,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:e},t,n)}function c(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function f(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function h(e){return 180*(e%(2*Math.PI))/Math.PI}function d(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=function(e,t,r){switch(e){case"Point":return n(t).geometry;case"LineString":return i(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return u(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return l(t).geometry;default:throw new Error(e+" is invalid")}},t.point=n,t.points=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return n(e,t)})),r)},t.polygon=o,t.polygons=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return o(e,t)})),r)},t.lineString=i,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return i(e,t)})),r)},t.featureCollection=a,t.multiLineString=s,t.multiPoint=u,t.multiPolygon=l,t.geometryCollection=function(e,t,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:e},t,n)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=c,t.lengthToRadians=f,t.lengthToDegrees=function(e,t){return h(f(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=h,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return c(f(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=t.areaFactors[r];if(!o)throw new Error("invalid original units");var i=t.areaFactors[n];if(!i)throw new Error("invalid final units");return e/o*i},t.isNumber=d,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!d(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}}));r(Ne);Ne.earthRadius,Ne.factors,Ne.unitsFactors,Ne.areaFactors,Ne.feature,Ne.geometry,Ne.point,Ne.points,Ne.polygon,Ne.polygons,Ne.lineString,Ne.lineStrings,Ne.featureCollection,Ne.multiLineString,Ne.multiPoint,Ne.multiPolygon,Ne.geometryCollection,Ne.round,Ne.radiansToLength,Ne.lengthToRadians,Ne.lengthToDegrees,Ne.bearingToAzimuth,Ne.radiansToDegrees,Ne.degreesToRadians,Ne.convertLength,Ne.convertArea,Ne.isNumber,Ne.isObject,Ne.validateBBox,Ne.validateId,Ne.radians2degrees,Ne.degrees2radians,Ne.distanceToDegrees,Ne.distanceToRadians,Ne.radiansToDistance,Ne.bearingToAngle,Ne.convertDistance;var Te=n((function(e,t){function r(e,t,n){if(null!==e)for(var o,i,a,s,u,l,c,f,h=0,d=0,g=e.type,p="FeatureCollection"===g,y="Feature"===g,m=p?e.features.length:1,v=0;v<m;v++){u=(f=!!(c=p?e.features[v].geometry:y?e.geometry:e)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var b=0;b<u;b++){var w=0,E=0;if(null!==(s=f?c.geometries[b]:c)){l=s.coordinates;var j=s.type;switch(h=!n||"Polygon"!==j&&"MultiPolygon"!==j?0:1,j){case null:break;case"Point":if(!1===t(l,d,v,w,E))return!1;d++,w++;break;case"LineString":case"MultiPoint":for(o=0;o<l.length;o++){if(!1===t(l[o],d,v,w,E))return!1;d++,"MultiPoint"===j&&w++}"LineString"===j&&w++;break;case"Polygon":case"MultiLineString":for(o=0;o<l.length;o++){for(i=0;i<l[o].length-h;i++){if(!1===t(l[o][i],d,v,w,E))return!1;d++}"MultiLineString"===j&&w++,"Polygon"===j&&E++}"Polygon"===j&&w++;break;case"MultiPolygon":for(o=0;o<l.length;o++){for(E=0,i=0;i<l[o].length;i++){for(a=0;a<l[o][i].length-h;a++){if(!1===t(l[o][i][a],d,v,w,E))return!1;d++}E++}w++}break;case"GeometryCollection":for(o=0;o<s.geometries.length;o++)if(!1===r(s.geometries[o],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function n(e,t){var r;switch(e.type){case"FeatureCollection":for(r=0;r<e.features.length&&!1!==t(e.features[r].properties,r);r++);break;case"Feature":t(e.properties,0)}}function o(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var r=0;r<e.features.length&&!1!==t(e.features[r],r);r++);}function i(e,t){var r,n,o,i,a,s,u,l,c,f,h=0,d="FeatureCollection"===e.type,g="Feature"===e.type,p=d?e.features.length:1;for(r=0;r<p;r++){for(s=d?e.features[r].geometry:g?e.geometry:e,l=d?e.features[r].properties:g?e.properties:{},c=d?e.features[r].bbox:g?e.bbox:void 0,f=d?e.features[r].id:g?e.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=u?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,h,l,c,f))return!1;break;case"GeometryCollection":for(n=0;n<i.geometries.length;n++)if(!1===t(i.geometries[n],h,l,c,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,l,c,f))return!1;h++}}function a(e,t){i(e,(function(e,r,n,o,i){var a,s=null===e?null:e.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==t(Ne.feature(e,n,{bbox:o,id:i}),r,0)&&void 0}switch(s){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<e.coordinates.length;u++){var l={type:a,coordinates:e.coordinates[u]};if(!1===t(Ne.feature(l,n),r,u))return!1}}))}function s(e,t){a(e,(function(e,n,o){var i=0;if(e.geometry){var a=e.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var s,u=0,l=0,c=0;return!1!==r(e,(function(r,a,f,h,d){if(void 0===s||n>u||h>l||d>c)return s=r,u=n,l=h,c=d,void(i=0);var g=Ne.lineString([s,r],e.properties);if(!1===t(g,n,o,d,i))return!1;i++,s=r}))&&void 0}}}))}function u(e,t){if(!e)throw new Error("geojson is required");a(e,(function(e,r,n){if(null!==e.geometry){var o=e.geometry.type,i=e.geometry.coordinates;switch(o){case"LineString":if(!1===t(e,r,n,0,0))return!1;break;case"Polygon":for(var a=0;a<i.length;a++)if(!1===t(Ne.lineString(i[a],e.properties),r,n,a))return!1}}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.coordEach=r,t.coordReduce=function(e,t,n,o){var i=n;return r(e,(function(e,r,o,a,s){i=0===r&&void 0===n?e:t(i,e,r,o,a,s)}),o),i},t.propEach=n,t.propReduce=function(e,t,r){var o=r;return n(e,(function(e,n){o=0===n&&void 0===r?e:t(o,e,n)})),o},t.featureEach=o,t.featureReduce=function(e,t,r){var n=r;return o(e,(function(e,o){n=0===o&&void 0===r?e:t(n,e,o)})),n},t.coordAll=function(e){var t=[];return r(e,(function(e){t.push(e)})),t},t.geomEach=i,t.geomReduce=function(e,t,r){var n=r;return i(e,(function(e,o,i,a,s){n=0===o&&void 0===r?e:t(n,e,o,i,a,s)})),n},t.flattenEach=a,t.flattenReduce=function(e,t,r){var n=r;return a(e,(function(e,o,i){n=0===o&&0===i&&void 0===r?e:t(n,e,o,i)})),n},t.segmentEach=s,t.segmentReduce=function(e,t,r){var n=r,o=!1;return s(e,(function(e,i,a,s,u){n=!1===o&&void 0===r?e:t(n,e,i,a,s,u),o=!0})),n},t.lineEach=u,t.lineReduce=function(e,t,r){var n=r;return u(e,(function(e,o,i,a){n=0===o&&void 0===r?e:t(n,e,o,i,a)})),n},t.findSegment=function(e,t){if(t=t||{},!Ne.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,o=t.multiFeatureIndex||0,i=t.geometryIndex||0,a=t.segmentIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),Ne.lineString([u[a],u[a+1]],s,t);case"Polygon":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a-1),Ne.lineString([u[i][a],u[i][a+1]],s,t);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),Ne.lineString([u[o][a],u[o][a+1]],s,t);case"MultiPolygon":return o<0&&(o=u.length+o),i<0&&(i=u[o].length+i),a<0&&(a=u[o][i].length-a-1),Ne.lineString([u[o][i][a],u[o][i][a+1]],s,t)}throw new Error("geojson is invalid")},t.findPoint=function(e,t){if(t=t||{},!Ne.isObject(t))throw new Error("options is invalid");var r,n=t.featureIndex||0,o=t.multiFeatureIndex||0,i=t.geometryIndex||0,a=t.coordIndex||0,s=t.properties;switch(e.type){case"FeatureCollection":n<0&&(n=e.features.length+n),s=s||e.features[n].properties,r=e.features[n].geometry;break;case"Feature":s=s||e.properties,r=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=e;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var u=r.coordinates;switch(r.type){case"Point":return Ne.point(u,s,t);case"MultiPoint":return o<0&&(o=u.length+o),Ne.point(u[o],s,t);case"LineString":return a<0&&(a=u.length+a),Ne.point(u[a],s,t);case"Polygon":return i<0&&(i=u.length+i),a<0&&(a=u[i].length+a),Ne.point(u[i][a],s,t);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),Ne.point(u[o][a],s,t);case"MultiPolygon":return o<0&&(o=u.length+o),i<0&&(i=u[o].length+i),a<0&&(a=u[o][i].length-a),Ne.point(u[o][i][a],s,t)}throw new Error("geojson is invalid")}}));r(Te);Te.coordEach,Te.coordReduce,Te.propEach,Te.propReduce,Te.featureEach,Te.featureReduce,Te.coordAll,Te.geomEach,Te.geomReduce,Te.flattenEach,Te.flattenReduce,Te.segmentEach,Te.segmentReduce,Te.lineEach,Te.lineReduce,Te.findSegment,Te.findPoint;var Me=r(n((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=6378137;function n(e){var t=0;if(e&&e.length>0){t+=Math.abs(o(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(o(e[r]))}return t}function o(e){var t,n,o,a,s,u,l=0,c=e.length;if(c>2){for(u=0;u<c;u++)u===c-2?(o=c-2,a=c-1,s=0):u===c-1?(o=c-1,a=0,s=1):(o=u,a=u+1,s=u+2),t=e[o],n=e[a],l+=(i(e[s][0])-i(t[0]))*Math.sin(i(n[1]));l=l*r*r/2}return l}function i(e){return e*Math.PI/180}t.default=function(e){return Te.geomReduce(e,(function(e,t){return e+function(e){var t,r=0;switch(e.type){case"Polygon":return n(e.coordinates);case"MultiPolygon":for(t=0;t<e.coordinates.length;t++)r+=n(e.coordinates[t]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(t)}),0)}}))),ke=n((function(e,t){function r(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function n(e,t,n){return void 0===n&&(n={}),r({type:"Point",coordinates:e},t,n)}function o(e,t,n){void 0===n&&(n={});for(var o=0,i=e;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,n)}function i(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,n)}function a(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function s(e,t,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:e},t,n)}function u(e,t,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:e},t,n)}function l(e,t,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:e},t,n)}function c(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function f(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function h(e){return 180*(e%(2*Math.PI))/Math.PI}function d(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=function(e,t,r){switch(e){case"Point":return n(t).geometry;case"LineString":return i(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return u(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return l(t).geometry;default:throw new Error(e+" is invalid")}},t.point=n,t.points=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return n(e,t)})),r)},t.polygon=o,t.polygons=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return o(e,t)})),r)},t.lineString=i,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return i(e,t)})),r)},t.featureCollection=a,t.multiLineString=s,t.multiPoint=u,t.multiPolygon=l,t.geometryCollection=function(e,t,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:e},t,n)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=c,t.lengthToRadians=f,t.lengthToDegrees=function(e,t){return h(f(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=h,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return c(f(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=t.areaFactors[r];if(!o)throw new Error("invalid original units");var i=t.areaFactors[n];if(!i)throw new Error("invalid final units");return e/o*i},t.isNumber=d,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!d(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}}));r(ke);ke.earthRadius,ke.factors,ke.unitsFactors,ke.areaFactors,ke.feature,ke.geometry,ke.point,ke.points,ke.polygon,ke.polygons,ke.lineString,ke.lineStrings,ke.featureCollection,ke.multiLineString,ke.multiPoint,ke.multiPolygon,ke.geometryCollection,ke.round,ke.radiansToLength,ke.lengthToRadians,ke.lengthToDegrees,ke.bearingToAzimuth,ke.radiansToDegrees,ke.degreesToRadians,ke.convertLength,ke.convertArea,ke.isNumber,ke.isObject,ke.validateBBox,ke.validateId,ke.radians2degrees,ke.degrees2radians,ke.distanceToDegrees,ke.distanceToRadians,ke.radiansToDistance,ke.bearingToAngle,ke.convertDistance;var Ce=n((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getCoord=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},t.getCoords=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},t.containsNumber=function e(t){if(t.length>1&&ke.isNumber(t[0])&&ke.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")},t.geojsonType=function(e,t,r){if(!t||!r)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.type)},t.featureOf=function(e,t,r){if(!e)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+e.geometry.type)},t.collectionOf=function(e,t,r){if(!e)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var n=0,o=e.features;n<o.length;n++){var i=o[n];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!i.geometry||i.geometry.type!==t)throw new Error("Invalid input to "+r+": must be a "+t+", given "+i.geometry.type)}},t.getGeom=function(e){return"Feature"===e.type?e.geometry:e},t.getType=function(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}}));r(Ce);Ce.getCoord,Ce.getCoords,Ce.containsNumber,Ce.geojsonType,Ce.featureOf,Ce.collectionOf,Ce.getGeom,Ce.getType;var Re=r(n((function(e,t){function r(e,t,r){var n=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,i=t.length-1;o<t.length;i=o++){var a=t[o][0],s=t[o][1],u=t[i][0],l=t[i][1];if(e[1]*(a-u)+s*(u-e[0])+l*(e[0]-a)==0&&(a-e[0])*(u-e[0])<=0&&(s-e[1])*(l-e[1])<=0)return!r;s>e[1]!=l>e[1]&&e[0]<(u-a)*(e[1]-s)/(l-s)+a&&(n=!n)}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var o=Ce.getCoord(e),i=Ce.getGeom(t),a=i.type,s=t.bbox,u=i.coordinates;if(s&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(o,s))return!1;"Polygon"===a&&(u=[u]);for(var l=!1,c=0;c<u.length&&!l;c++)if(r(o,u[c][0],n.ignoreBoundary)){for(var f=!1,h=1;h<u[c].length&&!f;)r(o,u[c][h],!n.ignoreBoundary)&&(f=!0),h++;f||(l=!0)}return l}}))),Ie=n((function(e,t){function r(e,t,r){void 0===r&&(r={});var n={type:"Feature"};return(0===r.id||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function n(e,t,n){return void 0===n&&(n={}),r({type:"Point",coordinates:e},t,n)}function o(e,t,n){void 0===n&&(n={});for(var o=0,i=e;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return r({type:"Polygon",coordinates:e},t,n)}function i(e,t,n){if(void 0===n&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return r({type:"LineString",coordinates:e},t,n)}function a(e,t){void 0===t&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function s(e,t,n){return void 0===n&&(n={}),r({type:"MultiLineString",coordinates:e},t,n)}function u(e,t,n){return void 0===n&&(n={}),r({type:"MultiPoint",coordinates:e},t,n)}function l(e,t,n){return void 0===n&&(n={}),r({type:"MultiPolygon",coordinates:e},t,n)}function c(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e*n}function f(e,r){void 0===r&&(r="kilometers");var n=t.factors[r];if(!n)throw new Error(r+" units is invalid");return e/n}function h(e){return 180*(e%(2*Math.PI))/Math.PI}function d(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)&&!/^\s*$/.test(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=r,t.geometry=function(e,t,r){switch(e){case"Point":return n(t).geometry;case"LineString":return i(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return u(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return l(t).geometry;default:throw new Error(e+" is invalid")}},t.point=n,t.points=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return n(e,t)})),r)},t.polygon=o,t.polygons=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return o(e,t)})),r)},t.lineString=i,t.lineStrings=function(e,t,r){return void 0===r&&(r={}),a(e.map((function(e){return i(e,t)})),r)},t.featureCollection=a,t.multiLineString=s,t.multiPoint=u,t.multiPolygon=l,t.geometryCollection=function(e,t,n){return void 0===n&&(n={}),r({type:"GeometryCollection",geometries:e},t,n)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,t||0);return Math.round(e*r)/r},t.radiansToLength=c,t.lengthToRadians=f,t.lengthToDegrees=function(e,t){return h(f(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=h,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,r){if(void 0===t&&(t="kilometers"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("length must be a positive number");return c(f(e,t),r)},t.convertArea=function(e,r,n){if(void 0===r&&(r="meters"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=t.areaFactors[r];if(!o)throw new Error("invalid original units");var i=t.areaFactors[n];if(!i)throw new Error("invalid final units");return e/o*i},t.isNumber=d,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!d(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")},t.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},t.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},t.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},t.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},t.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},t.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},t.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}}));r(Ie);Ie.earthRadius,Ie.factors,Ie.unitsFactors,Ie.areaFactors,Ie.feature,Ie.geometry,Ie.point,Ie.points,Ie.polygon,Ie.polygons,Ie.lineString,Ie.lineStrings,Ie.featureCollection,Ie.multiLineString,Ie.multiPoint,Ie.multiPolygon,Ie.geometryCollection,Ie.round,Ie.radiansToLength,Ie.lengthToRadians,Ie.lengthToDegrees,Ie.bearingToAzimuth,Ie.radiansToDegrees,Ie.degreesToRadians,Ie.convertLength,Ie.convertArea,Ie.isNumber,Ie.isObject,Ie.validateBBox,Ie.validateId,Ie.radians2degrees,Ie.degrees2radians,Ie.distanceToDegrees,Ie.distanceToRadians,Ie.radiansToDistance,Ie.bearingToAngle,Ie.convertDistance;var Le=r(n((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){void 0===t&&(t={});var r=Number(e[0]),n=Number(e[1]),o=Number(e[2]),i=Number(e[3]);if(6===e.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[r,n],s=[r,i],u=[o,i],l=[o,n];return Ie.polygon([[a,l,u,s,a]],t.properties,{bbox:e,id:t.id})}})));var Fe=function(){this.__data__=[],this.size=0};var De=function(e,t){return e===t||e!=e&&t!=t};var Be=function(e,t){for(var r=e.length;r--;)if(De(e[r][0],t))return r;return-1},Ve=Array.prototype.splice;var qe=function(e){var t=this.__data__,r=Be(t,e);return!(r<0)&&(r==t.length-1?t.pop():Ve.call(t,r,1),--this.size,!0)};var Ge=function(e){var t=this.__data__,r=Be(t,e);return r<0?void 0:t[r][1]};var ze=function(e){return Be(this.__data__,e)>-1};var Ue=function(e,t){var r=this.__data__,n=Be(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function Je(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Je.prototype.clear=Fe,Je.prototype.delete=qe,Je.prototype.get=Ge,Je.prototype.has=ze,Je.prototype.set=Ue;var $e=Je;var We=function(){this.__data__=new $e,this.size=0};var Xe=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var Ye=function(e){return this.__data__.get(e)};var Ze=function(e){return this.__data__.has(e)},He="object"==typeof t&&t&&t.Object===Object&&t,Ke="object"==typeof self&&self&&self.Object===Object&&self,Qe=He||Ke||Function("return this")(),et=Qe.Symbol,tt=Object.prototype,rt=tt.hasOwnProperty,nt=tt.toString,ot=et?et.toStringTag:void 0;var it=function(e){var t=rt.call(e,ot),r=e[ot];try{e[ot]=void 0;var n=!0}catch(e){}var o=nt.call(e);return n&&(t?e[ot]=r:delete e[ot]),o},at=Object.prototype.toString;var st=function(e){return at.call(e)},ut="[object Null]",lt="[object Undefined]",ct=et?et.toStringTag:void 0;var ft=function(e){return null==e?void 0===e?lt:ut:ct&&ct in Object(e)?it(e):st(e)};var ht=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},dt="[object AsyncFunction]",gt="[object Function]",pt="[object GeneratorFunction]",yt="[object Proxy]";var mt,vt=function(e){if(!ht(e))return!1;var t=ft(e);return t==gt||t==pt||t==dt||t==yt},bt=Qe["__core-js_shared__"],wt=(mt=/[^.]+$/.exec(bt&&bt.keys&&bt.keys.IE_PROTO||""))?"Symbol(src)_1."+mt:"";var Et=function(e){return!!wt&&wt in e},jt=Function.prototype.toString;var Pt=function(e){if(null!=e){try{return jt.call(e)}catch(e){}try{return e+""}catch(e){}}return""},At=/^\[object .+?Constructor\]$/,xt=Function.prototype,_t=Object.prototype,Ot=xt.toString,St=_t.hasOwnProperty,Nt=RegExp("^"+Ot.call(St).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Tt=function(e){return!(!ht(e)||Et(e))&&(vt(e)?Nt:At).test(Pt(e))};var Mt=function(e,t){return null==e?void 0:e[t]};var kt=function(e,t){var r=Mt(e,t);return Tt(r)?r:void 0},Ct=kt(Qe,"Map"),Rt=kt(Object,"create");var It=function(){this.__data__=Rt?Rt(null):{},this.size=0};var Lt=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ft="__lodash_hash_undefined__",Dt=Object.prototype.hasOwnProperty;var Bt=function(e){var t=this.__data__;if(Rt){var r=t[e];return r===Ft?void 0:r}return Dt.call(t,e)?t[e]:void 0},Vt=Object.prototype.hasOwnProperty;var qt=function(e){var t=this.__data__;return Rt?void 0!==t[e]:Vt.call(t,e)},Gt="__lodash_hash_undefined__";var zt=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Rt&&void 0===t?Gt:t,this};function Ut(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ut.prototype.clear=It,Ut.prototype.delete=Lt,Ut.prototype.get=Bt,Ut.prototype.has=qt,Ut.prototype.set=zt;var Jt=Ut;var $t=function(){this.size=0,this.__data__={hash:new Jt,map:new(Ct||$e),string:new Jt}};var Wt=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Xt=function(e,t){var r=e.__data__;return Wt(t)?r["string"==typeof t?"string":"hash"]:r.map};var Yt=function(e){var t=Xt(this,e).delete(e);return this.size-=t?1:0,t};var Zt=function(e){return Xt(this,e).get(e)};var Ht=function(e){return Xt(this,e).has(e)};var Kt=function(e,t){var r=Xt(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Qt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Qt.prototype.clear=$t,Qt.prototype.delete=Yt,Qt.prototype.get=Zt,Qt.prototype.has=Ht,Qt.prototype.set=Kt;var er=Qt,tr=200;var rr=function(e,t){var r=this.__data__;if(r instanceof $e){var n=r.__data__;if(!Ct||n.length<tr-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new er(n)}return r.set(e,t),this.size=r.size,this};function nr(e){var t=this.__data__=new $e(e);this.size=t.size}nr.prototype.clear=We,nr.prototype.delete=Xe,nr.prototype.get=Ye,nr.prototype.has=Ze,nr.prototype.set=rr;var or=nr;var ir=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},ar=function(){try{var e=kt(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var sr=function(e,t,r){"__proto__"==t&&ar?ar(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},ur=Object.prototype.hasOwnProperty;var lr=function(e,t,r){var n=e[t];ur.call(e,t)&&De(n,r)&&(void 0!==r||t in e)||sr(e,t,r)};var cr=function(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),o?sr(r,s,u):lr(r,s,u)}return r};var fr=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var hr=function(e){return null!=e&&"object"==typeof e},dr="[object Arguments]";var gr=function(e){return hr(e)&&ft(e)==dr},pr=Object.prototype,yr=pr.hasOwnProperty,mr=pr.propertyIsEnumerable,vr=gr(function(){return arguments}())?gr:function(e){return hr(e)&&yr.call(e,"callee")&&!mr.call(e,"callee")},br=Array.isArray;var wr=function(){return!1},Er=n((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?Qe.Buffer:void 0,i=(o?o.isBuffer:void 0)||wr;e.exports=i})),jr=9007199254740991,Pr=/^(?:0|[1-9]\d*)$/;var Ar=function(e,t){var r=typeof e;return!!(t=null==t?jr:t)&&("number"==r||"symbol"!=r&&Pr.test(e))&&e>-1&&e%1==0&&e<t},xr=9007199254740991;var _r=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=xr},Or={};Or["[object Float32Array]"]=Or["[object Float64Array]"]=Or["[object Int8Array]"]=Or["[object Int16Array]"]=Or["[object Int32Array]"]=Or["[object Uint8Array]"]=Or["[object Uint8ClampedArray]"]=Or["[object Uint16Array]"]=Or["[object Uint32Array]"]=!0,Or["[object Arguments]"]=Or["[object Array]"]=Or["[object ArrayBuffer]"]=Or["[object Boolean]"]=Or["[object DataView]"]=Or["[object Date]"]=Or["[object Error]"]=Or["[object Function]"]=Or["[object Map]"]=Or["[object Number]"]=Or["[object Object]"]=Or["[object RegExp]"]=Or["[object Set]"]=Or["[object String]"]=Or["[object WeakMap]"]=!1;var Sr=function(e){return hr(e)&&_r(e.length)&&!!Or[ft(e)]};var Nr=function(e){return function(t){return e(t)}},Tr=n((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r&&He.process,i=function(){try{var e=n&&n.require&&n.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=i})),Mr=Tr&&Tr.isTypedArray,kr=Mr?Nr(Mr):Sr,Cr=Object.prototype.hasOwnProperty;var Rr=function(e,t){var r=br(e),n=!r&&vr(e),o=!r&&!n&&Er(e),i=!r&&!n&&!o&&kr(e),a=r||n||o||i,s=a?fr(e.length,String):[],u=s.length;for(var l in e)!t&&!Cr.call(e,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Ar(l,u))||s.push(l);return s},Ir=Object.prototype;var Lr=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ir)};var Fr=function(e,t){return function(r){return e(t(r))}},Dr=Fr(Object.keys,Object),Br=Object.prototype.hasOwnProperty;var Vr=function(e){if(!Lr(e))return Dr(e);var t=[];for(var r in Object(e))Br.call(e,r)&&"constructor"!=r&&t.push(r);return t};var qr=function(e){return null!=e&&_r(e.length)&&!vt(e)};var Gr=function(e){return qr(e)?Rr(e):Vr(e)};var zr=function(e,t){return e&&cr(t,Gr(t),e)};var Ur=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},Jr=Object.prototype.hasOwnProperty;var $r=function(e){if(!ht(e))return Ur(e);var t=Lr(e),r=[];for(var n in e)("constructor"!=n||!t&&Jr.call(e,n))&&r.push(n);return r};var Wr=function(e){return qr(e)?Rr(e,!0):$r(e)};var Xr=function(e,t){return e&&cr(t,Wr(t),e)},Yr=n((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?Qe.Buffer:void 0,i=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=i?i(r):new e.constructor(r);return e.copy(n),n}}));var Zr=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var Hr=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i};var Kr=function(){return[]},Qr=Object.prototype.propertyIsEnumerable,en=Object.getOwnPropertySymbols,tn=en?function(e){return null==e?[]:(e=Object(e),Hr(en(e),(function(t){return Qr.call(e,t)})))}:Kr;var rn=function(e,t){return cr(e,tn(e),t)};var nn=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},on=Fr(Object.getPrototypeOf,Object),an=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)nn(t,tn(e)),e=on(e);return t}:Kr;var sn=function(e,t){return cr(e,an(e),t)};var un=function(e,t,r){var n=t(e);return br(e)?n:nn(n,r(e))};var ln=function(e){return un(e,Gr,tn)};var cn=function(e){return un(e,Wr,an)},fn=kt(Qe,"DataView"),hn=kt(Qe,"Promise"),dn=kt(Qe,"Set"),gn=kt(Qe,"WeakMap"),pn=Pt(fn),yn=Pt(Ct),mn=Pt(hn),vn=Pt(dn),bn=Pt(gn),wn=ft;(fn&&"[object DataView]"!=wn(new fn(new ArrayBuffer(1)))||Ct&&"[object Map]"!=wn(new Ct)||hn&&"[object Promise]"!=wn(hn.resolve())||dn&&"[object Set]"!=wn(new dn)||gn&&"[object WeakMap]"!=wn(new gn))&&(wn=function(e){var t=ft(e),r="[object Object]"==t?e.constructor:void 0,n=r?Pt(r):"";if(n)switch(n){case pn:return"[object DataView]";case yn:return"[object Map]";case mn:return"[object Promise]";case vn:return"[object Set]";case bn:return"[object WeakMap]"}return t});var En=wn,jn=Object.prototype.hasOwnProperty;var Pn=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&jn.call(e,"index")&&(r.index=e.index,r.input=e.input),r},An=Qe.Uint8Array;var xn=function(e){var t=new e.constructor(e.byteLength);return new An(t).set(new An(e)),t};var _n=function(e,t){var r=t?xn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},On=/\w*$/;var Sn=function(e){var t=new e.constructor(e.source,On.exec(e));return t.lastIndex=e.lastIndex,t},Nn=et?et.prototype:void 0,Tn=Nn?Nn.valueOf:void 0;var Mn=function(e){return Tn?Object(Tn.call(e)):{}};var kn=function(e,t){var r=t?xn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},Cn="[object Boolean]",Rn="[object Date]",In="[object Map]",Ln="[object Number]",Fn="[object RegExp]",Dn="[object Set]",Bn="[object String]",Vn="[object Symbol]",qn="[object ArrayBuffer]",Gn="[object DataView]",zn="[object Float32Array]",Un="[object Float64Array]",Jn="[object Int8Array]",$n="[object Int16Array]",Wn="[object Int32Array]",Xn="[object Uint8Array]",Yn="[object Uint8ClampedArray]",Zn="[object Uint16Array]",Hn="[object Uint32Array]";var Kn=function(e,t,r){var n=e.constructor;switch(t){case qn:return xn(e);case Cn:case Rn:return new n(+e);case Gn:return _n(e,r);case zn:case Un:case Jn:case $n:case Wn:case Xn:case Yn:case Zn:case Hn:return kn(e,r);case In:return new n;case Ln:case Bn:return new n(e);case Fn:return Sn(e);case Dn:return new n;case Vn:return Mn(e)}},Qn=Object.create,eo=function(){function e(){}return function(t){if(!ht(t))return{};if(Qn)return Qn(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var to=function(e){return"function"!=typeof e.constructor||Lr(e)?{}:eo(on(e))},ro="[object Map]";var no=function(e){return hr(e)&&En(e)==ro},oo=Tr&&Tr.isMap,io=oo?Nr(oo):no,ao="[object Set]";var so=function(e){return hr(e)&&En(e)==ao},uo=Tr&&Tr.isSet,lo=uo?Nr(uo):so,co=1,fo=2,ho=4,go="[object Arguments]",po="[object Function]",yo="[object GeneratorFunction]",mo="[object Object]",vo={};vo[go]=vo["[object Array]"]=vo["[object ArrayBuffer]"]=vo["[object DataView]"]=vo["[object Boolean]"]=vo["[object Date]"]=vo["[object Float32Array]"]=vo["[object Float64Array]"]=vo["[object Int8Array]"]=vo["[object Int16Array]"]=vo["[object Int32Array]"]=vo["[object Map]"]=vo["[object Number]"]=vo[mo]=vo["[object RegExp]"]=vo["[object Set]"]=vo["[object String]"]=vo["[object Symbol]"]=vo["[object Uint8Array]"]=vo["[object Uint8ClampedArray]"]=vo["[object Uint16Array]"]=vo["[object Uint32Array]"]=!0,vo["[object Error]"]=vo[po]=vo["[object WeakMap]"]=!1;var bo=function e(t,r,n,o,i,a){var s,u=r&co,l=r&fo,c=r&ho;if(n&&(s=i?n(t,o,i,a):n(t)),void 0!==s)return s;if(!ht(t))return t;var f=br(t);if(f){if(s=Pn(t),!u)return Zr(t,s)}else{var h=En(t),d=h==po||h==yo;if(Er(t))return Yr(t,u);if(h==mo||h==go||d&&!i){if(s=l||d?{}:to(t),!u)return l?sn(t,Xr(s,t)):rn(t,zr(s,t))}else{if(!vo[h])return i?t:{};s=Kn(t,h,u)}}a||(a=new or);var g=a.get(t);if(g)return g;a.set(t,s),lo(t)?t.forEach((function(o){s.add(e(o,r,n,o,t,a))})):io(t)&&t.forEach((function(o,i){s.set(i,e(o,r,n,i,t,a))}));var p=c?l?cn:ln:l?keysIn:Gr,y=f?void 0:p(t);return ir(y||t,(function(o,i){y&&(o=t[i=o]),lr(s,i,e(o,r,n,i,t,a))})),s},wo=4;var Eo=function(e){return bo(e,wo)};function jo(e,t){return e>t?1:e<t?-1:0}class Po{constructor(e=jo,t=!1){this._compare=e,this._root=null,this._size=0,this._noDuplicates=!!t}rotateLeft(e){var t=e.right;t&&(e.right=t.left,t.left&&(t.left.parent=e),t.parent=e.parent),e.parent?e===e.parent.left?e.parent.left=t:e.parent.right=t:this._root=t,t&&(t.left=e),e.parent=t}rotateRight(e){var t=e.left;t&&(e.left=t.right,t.right&&(t.right.parent=e),t.parent=e.parent),e.parent?e===e.parent.left?e.parent.left=t:e.parent.right=t:this._root=t,t&&(t.right=e),e.parent=t}_splay(e){for(;e.parent;){var t=e.parent;t.parent?t.left===e&&t.parent.left===t?(this.rotateRight(t.parent),this.rotateRight(t)):t.right===e&&t.parent.right===t?(this.rotateLeft(t.parent),this.rotateLeft(t)):t.left===e&&t.parent.right===t?(this.rotateRight(t),this.rotateLeft(t)):(this.rotateLeft(t),this.rotateRight(t)):t.left===e?this.rotateRight(t):this.rotateLeft(t)}}splay(e){for(var t,r,n,o,i;e.parent;)(r=(t=e.parent).parent)&&r.parent?((n=r.parent).left===r?n.left=e:n.right=e,e.parent=n):(e.parent=null,this._root=e),o=e.left,i=e.right,e===t.left?(r&&(r.left===t?(t.right?(r.left=t.right,r.left.parent=r):r.left=null,t.right=r,r.parent=t):(o?(r.right=o,o.parent=r):r.right=null,e.left=r,r.parent=e)),i?(t.left=i,i.parent=t):t.left=null,e.right=t,t.parent=e):(r&&(r.right===t?(t.left?(r.right=t.left,r.right.parent=r):r.right=null,t.left=r,r.parent=t):(i?(r.left=i,i.parent=r):r.left=null,e.right=r,r.parent=e)),o?(t.right=o,o.parent=t):t.right=null,e.left=t,t.parent=e)}replace(e,t){e.parent?e===e.parent.left?e.parent.left=t:e.parent.right=t:this._root=t,t&&(t.parent=e.parent)}minNode(e=this._root){if(e)for(;e.left;)e=e.left;return e}maxNode(e=this._root){if(e)for(;e.right;)e=e.right;return e}insert(e,t){var r=this._root,n=null,o=this._compare;if(this._noDuplicates)for(;r;){if(n=r,0===o(r.key,e))return;r=o(r.key,e)<0?r.right:r.left}else for(;r;)n=r,r=o(r.key,e)<0?r.right:r.left;return r={key:e,data:t,left:null,right:null,parent:n},n?o(n.key,r.key)<0?n.right=r:n.left=r:this._root=r,this.splay(r),this._size++,r}find(e){for(var t=this._root,r=this._compare;t;){var n=r(t.key,e);if(n<0)t=t.right;else{if(!(n>0))return t;t=t.left}}return null}contains(e){for(var t=this._root,r=this._compare;t;){var n=r(e,t.key);if(0===n)return!0;t=n<0?t.left:t.right}return!1}remove(e){var t=this.find(e);if(!t)return!1;if(this.splay(t),t.left)if(t.right){var r=this.minNode(t.right);r.parent!==t&&(this.replace(r,r.right),r.right=t.right,r.right.parent=r),this.replace(t,r),r.left=t.left,r.left.parent=r}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0}removeNode(e){if(!e)return!1;if(this.splay(e),e.left)if(e.right){var t=this.minNode(e.right);t.parent!==e&&(this.replace(t,t.right),t.right=e.right,t.right.parent=t),this.replace(e,t),t.left=e.left,t.left.parent=t}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0}erase(e){var t=this.find(e);if(t){this.splay(t);var r=t.left,n=t.right,o=null;r&&(r.parent=null,o=this.maxNode(r),this.splay(o),this._root=o),n&&(r?o.right=n:this._root=n,n.parent=o),this._size--}}pop(){var e=this._root,t=null;if(e){for(;e.left;)e=e.left;t={key:e.key,data:e.data},this.remove(e.key)}return t}next(e){var t=e;if(t)if(t.right)for(t=t.right;t&&t.left;)t=t.left;else for(t=e.parent;t&&t.right===e;)e=t,t=t.parent;return t}prev(e){var t=e;if(t)if(t.left)for(t=t.left;t&&t.right;)t=t.right;else for(t=e.parent;t&&t.left===e;)e=t,t=t.parent;return t}forEach(e){for(var t=this._root,r=[],n=!1,o=0;!n;)t?(r.push(t),t=t.left):r.length>0?(e(t=r.pop(),o++),t=t.right):n=!0;return this}range(e,t,r,n){const o=[],i=this._compare;let a,s=this._root;for(;0!==o.length||s;)if(s)o.push(s),s=s.left;else{if((a=i((s=o.pop()).key,t))>0)break;if(i(s.key,e)>=0&&r.call(n,s))return this;s=s.right}return this}keys(){for(var e=this._root,t=[],r=[],n=!1;!n;)e?(t.push(e),e=e.left):t.length>0?(e=t.pop(),r.push(e.key),e=e.right):n=!0;return r}values(){for(var e=this._root,t=[],r=[],n=!1;!n;)e?(t.push(e),e=e.left):t.length>0?(e=t.pop(),r.push(e.data),e=e.right):n=!0;return r}at(e){for(var t=this._root,r=[],n=!1,o=0;!n;)if(t)r.push(t),t=t.left;else if(r.length>0){if(t=r.pop(),o===e)return t;o++,t=t.right}else n=!0;return null}load(e=[],t=[],r=!1){if(0!==this._size)throw new Error("bulk-load: tree is not empty");const n=e.length;return r&&function e(t,r,n,o,i){if(n>=o)return;const a=t[n+o>>1];let s=n-1;let u=o+1;for(;;){do{s++}while(i(t[s],a)<0);do{u--}while(i(t[u],a)>0);if(s>=u)break;let e=t[s];t[s]=t[u],t[u]=e,e=r[s],r[s]=r[u],r[u]=e}e(t,r,n,u,i);e(t,r,u+1,o,i)}(e,t,0,n-1,this._compare),this._root=function e(t,r,n,o,i){const a=i-o;if(a>0){const s=o+Math.floor(a/2),u=r[s],l=n[s],c={key:u,data:l,parent:t};return c.left=e(c,r,n,o,s),c.right=e(c,r,n,s+1,i),c}return null}(null,e,t,0,n),this._size=n,this}min(){var e=this.minNode(this._root);return e?e.key:null}max(){var e=this.maxNode(this._root);return e?e.key:null}isEmpty(){return null===this._root}get size(){return this._size}static createTree(e,t,r,n,o){return new Po(r,o).load(e,t,n)}}const Ao=0,xo=1,_o=2,Oo=3,So=0,No=1,To=2,Mo=3;function ko(e,t,r){null===t?(e.inOut=!1,e.otherInOut=!0):(e.isSubject===t.isSubject?(e.inOut=!t.inOut,e.otherInOut=t.otherInOut):(e.inOut=!t.otherInOut,e.otherInOut=t.isVertical()?!t.inOut:t.inOut),t&&(e.prevInResult=!Co(t,r)||t.isVertical()?t.prevInResult:t)),e.inResult=Co(e,r)}function Co(e,t){switch(e.type){case Ao:switch(t){case So:return!e.otherInOut;case No:return e.otherInOut;case To:return e.isSubject&&e.otherInOut||!e.isSubject&&!e.otherInOut;case Mo:return!0}break;case _o:return t===So||t===No;case Oo:return t===To;case xo:return!1}return!1}class Ro{constructor(e,t,r,n,o){this.left=t,this.point=e,this.otherEvent=r,this.isSubject=n,this.type=o||Ao,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.inResult=!1,this.resultInOut=!1,this.isExteriorRing=!0}isBelow(e){const t=this.point,r=this.otherEvent.point;return this.left?(t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1])>0:(r[0]-e[0])*(t[1]-e[1])-(t[0]-e[0])*(r[1]-e[1])>0}isAbove(e){return!this.isBelow(e)}isVertical(){return this.point[0]===this.otherEvent.point[0]}clone(){const e=new Ro(this.point,this.left,this.otherEvent,this.isSubject,this.type);return e.inResult=this.inResult,e.prevInResult=this.prevInResult,e.isExteriorRing=this.isExteriorRing,e.inOut=this.inOut,e.otherInOut=this.otherInOut,e}}function Io(e,t){return e[0]===t[0]&&e[1]===t[1]}function Lo(e,t,r){return(e[0]-r[0])*(t[1]-r[1])-(t[0]-r[0])*(e[1]-r[1])}function Fo(e,t){const r=e.point,n=t.point;return r[0]>n[0]?1:r[0]<n[0]?-1:r[1]!==n[1]?r[1]>n[1]?1:-1:function(e,t,r,n){if(e.left!==t.left)return e.left?1:-1;if(0!==Lo(r,e.otherEvent.point,t.otherEvent.point))return e.isBelow(t.otherEvent.point)?-1:1;return!e.isSubject&&t.isSubject?1:-1}(e,t,r)}function Do(e,t,r){const n=new Ro(t,!1,e,e.isSubject),o=new Ro(t,!0,e.otherEvent,e.isSubject);return Io(e.point,e.otherEvent.point)&&console.warn("what is that, a collapsed segment?",e),n.contourId=o.contourId=e.contourId,Fo(o,e.otherEvent)>0&&(e.otherEvent.left=!0,o.left=!1),e.otherEvent.otherEvent=o,e.otherEvent=n,r.push(o),r.push(n),r}function Bo(e,t){return e[0]*t[1]-e[1]*t[0]}function Vo(e,t){return e[0]*t[0]+e[1]*t[1]}function qo(e,t,r){const n=function(e,t,r,n,o){const i=[t[0]-e[0],t[1]-e[1]],a=[n[0]-r[0],n[1]-r[1]];function s(e,t,r){return[e[0]+t*r[0],e[1]+t*r[1]]}const u=[r[0]-e[0],r[1]-e[1]];let l=Bo(i,a),c=l*l;const f=Vo(i,i);if(c>0){const t=Bo(u,a)/l;if(t<0||t>1)return null;const n=Bo(u,i)/l;return n<0||n>1?null:0===t||1===t?o?null:[s(e,t,i)]:0===n||1===n?o?null:[s(r,n,a)]:[s(e,t,i)]}if((c=(l=Bo(u,i))*l)>0)return null;const h=Vo(i,u)/f,d=h+Vo(i,a)/f,g=Math.min(h,d),p=Math.max(h,d);return g<=1&&p>=0?1===g?o?null:[s(e,g>0?g:0,i)]:0===p?o?null:[s(e,p<1?p:1,i)]:o&&0===g&&1===p?null:[s(e,g>0?g:0,i),s(e,p<1?p:1,i)]:null}(e.point,e.otherEvent.point,t.point,t.otherEvent.point),o=n?n.length:0;if(0===o)return 0;if(1===o&&(Io(e.point,t.point)||Io(e.otherEvent.point,t.otherEvent.point)))return 0;if(2===o&&e.isSubject===t.isSubject)return 0;if(1===o)return Io(e.point,n[0])||Io(e.otherEvent.point,n[0])||Do(e,n[0],r),Io(t.point,n[0])||Io(t.otherEvent.point,n[0])||Do(t,n[0],r),1;const i=[];let a=!1,s=!1;return Io(e.point,t.point)?a=!0:1===Fo(e,t)?i.push(t,e):i.push(e,t),Io(e.otherEvent.point,t.otherEvent.point)?s=!0:1===Fo(e.otherEvent,t.otherEvent)?i.push(t.otherEvent,e.otherEvent):i.push(e.otherEvent,t.otherEvent),a&&s||a?(t.type=xo,e.type=t.inOut===e.inOut?_o:Oo,a&&!s&&Do(i[1].otherEvent,i[0].point,r),2):s?(Do(i[0],i[1].point,r),3):i[0]!==i[3].otherEvent?(Do(i[0],i[1].point,r),Do(i[1],i[2].point,r),3):(Do(i[0],i[1].point,r),Do(i[3].otherEvent,i[2].point,r),3)}function Go(e,t){if(e===t)return 0;if(0!==Lo(e.point,e.otherEvent.point,t.point)||0!==Lo(e.point,e.otherEvent.point,t.otherEvent.point))return Io(e.point,t.point)?e.isBelow(t.otherEvent.point)?-1:1:e.point[0]===t.point[0]?e.point[1]<t.point[1]?-1:1:1===Fo(e,t)?t.isAbove(e.point)?-1:1:e.isBelow(t.point)?-1:1;if(e.isSubject!==t.isSubject)return e.isSubject?-1:1;{let r=e.point,n=t.point;if(r[0]===n[0]&&r[1]===n[1])return r=e.otherEvent.point,n=t.otherEvent.point,r[0]===n[0]&&r[1]===n[1]?0:e.contourId>t.contourId?1:-1}return 1===Fo(e,t)?1:-1}function zo(e,t,r,n){let o,i,a=e+1;const s=t.length;for(o=t[e].point,a<s&&(i=t[a].point);a<s&&i[0]===o[0]&&i[1]===o[1];){if(!r[a])return a;i=t[++a].point}for(a=e-1;r[a]&&a>=n;)a--;return a}function Uo(e,t){let r,n;const o=function(e){let t,r,n,o;const i=[];for(r=0,n=e.length;r<n;r++)((t=e[r]).left&&t.inResult||!t.left&&t.otherEvent.inResult)&&i.push(t);let a=!1;for(;!a;)for(a=!0,r=0,n=i.length;r<n;r++)r+1<n&&1===Fo(i[r],i[r+1])&&(o=i[r],i[r]=i[r+1],i[r+1]=o,a=!1);for(r=0,n=i.length;r<n;r++)(t=i[r]).pos=r;for(r=0,n=i.length;r<n;r++)(t=i[r]).left||(o=t.pos,t.pos=t.otherEvent.pos,t.otherEvent.pos=o);return i}(e),i={},a=[];let s;for(r=0,n=o.length;r<n;r++){if(i[r])continue;const e=[[]];o[r].isExteriorRing?t===To&&!o[r].isSubject&&a.length>1?a[a.length-1].push(e[0]):a.push(e):t!==To||o[r].isSubject||0!==a.length?0===a.length?a.push([[e]]):a[a.length-1].push(e[0]):a.push(e);const n=a.length-1;let u=r;const l=o[r].point;for(e[0].push(l);u>=r;)s=o[u],i[u]=!0,s.left?(s.resultInOut=!1,s.contourId=n):(s.otherEvent.resultInOut=!0,s.otherEvent.contourId=n),i[u=s.pos]=!0,e[0].push(o[u].point),u=zo(u,o,i,r);s=o[u=-1===u?r:u],i[u]=i[s.pos]=!0,s.otherEvent.resultInOut=!0,s.otherEvent.contourId=n}return a}var Jo=Wo,$o=Wo;function Wo(e,t){if(!(this instanceof Wo))return new Wo(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||Xo,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function Xo(e,t){return e<t?-1:e>t?1:0}Wo.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,r=this.compare,n=t[e];e>0;){var o=e-1>>1,i=t[o];if(r(n,i)>=0)break;t[e]=i,e=o}t[e]=n},_down:function(e){for(var t=this.data,r=this.compare,n=this.length>>1,o=t[e];e<n;){var i=1+(e<<1),a=i+1,s=t[i];if(a<this.length&&r(t[a],s)<0&&(i=a,s=t[a]),r(s,o)>=0)break;t[e]=s,e=i}t[e]=o}},Jo.default=$o;const Yo=Math.max,Zo=Math.min;let Ho=0;function Ko(e,t,r,n,o,i){let a,s,u,l,c,f;for(a=0,s=e.length-1;a<s;a++){if(u=e[a],l=e[a+1],c=new Ro(u,!1,void 0,t),f=new Ro(l,!1,c,t),c.otherEvent=f,u[0]===l[0]&&u[1]===l[1])continue;c.contourId=f.contourId=r,i||(c.isExteriorRing=!1,f.isExteriorRing=!1),Fo(c,f)>0?f.left=!0:c.left=!0;const s=u[0],h=u[1];o[0]=Zo(o[0],s),o[1]=Zo(o[1],h),o[2]=Yo(o[2],s),o[3]=Yo(o[3],h),n.push(c),n.push(f)}}const Qo=[];function ei(e,t,r){"number"==typeof e[0][0][0]&&(e=[e]),"number"==typeof t[0][0][0]&&(t=[t]);let n=function(e,t,r){let n=null;return e.length*t.length==0&&(r===So?n=Qo:r===To?n=e:r!==No&&r!==Mo||(n=0===e.length?t:e)),n}(e,t,r);if(n)return n===Qo?null:n;const o=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],a=function(e,t,r,n,o){const i=new Jo(null,Fo);let a,s,u,l,c,f;for(u=0,l=e.length;u<l;u++)for(c=0,f=(a=e[u]).length;c<f;c++)(s=0===c)&&Ho++,Ko(a[c],!0,Ho,i,r,s);for(u=0,l=t.length;u<l;u++)for(c=0,f=(a=t[u]).length;c<f;c++)s=0===c,o===To&&(s=!1),s&&Ho++,Ko(a[c],!1,Ho,i,n,s);return i}(e,t,o,i,r);return(n=function(e,t,r,n,o){let i=null;return(r[0]>n[2]||n[0]>r[2]||r[1]>n[3]||n[1]>r[3])&&(o===So?i=Qo:o===To?i=e:o!==No&&o!==Mo||(i=e.concat(t))),i}(e,t,o,i,r))?n===Qo?null:n:Uo(function(e,t,r,n,o,i){const a=new Po(Go),s=[],u=Math.min(n[2],o[2]);let l,c,f;for(;0!==e.length;){let t=e.pop();if(s.push(t),i===So&&t.point[0]>u||i===To&&t.point[0]>n[2])break;if(t.left){c=l=a.insert(t),l=l!==(f=a.minNode())?a.prev(l):null,c=a.next(c);const r=l?l.key:null;let n;if(ko(t,r,i),c&&2===qo(t,c.key,e)&&(ko(t,r,i),ko(t,c.key,i)),l&&2===qo(l.key,t,e)){let e=l;ko(r,n=(e=e!==f?a.prev(e):null)?e.key:null,i),ko(t,r,i)}}else t=t.otherEvent,c=l=a.find(t),l&&c&&(l=l!==f?a.prev(l):null,c=a.next(c),a.remove(t),c&&l&&qo(l.key,c.key,e))}return s}(a,0,0,o,i,r),r)}var ti=function(e,t){for(var r=e[0],n=e[1],o=!1,i=0,a=t.length-1;i<t.length;a=i++){var s=t[i][0],u=t[i][1],l=t[a][0],c=t[a][1];u>n!=c>n&&r<(l-s)*(n-u)/(c-u)+s&&(o=!o)}return o};function ri(e){if("Point"!==e.geometry.type){switch(e.properties.way_geometry=Eo(e.geometry),e.geometry.type){case"Polygon":"function"==typeof Me&&(e.properties.mesure=Me(e.geometry));break;case"LineString":"function"==typeof length&&(e.properties.mesure=length(e))}e.geometry=Oe(e.geometry).geometry}}function ni(e){if("no"===e.area)return!1;var t=Object.keys(e);return!(!t.includes("building")||"no"===e.building)||(!(!t.includes("landuse")||"no"===e.landuse)||(!(!t.includes("amenity")||"no"===e.amenity)||(!(!t.includes("leisure")||"no"===e.leisure)||(!(!t.includes("area")||"no"===e.area)||(!(!t.includes("place")||"no"===e.place)||(!(!t.includes("shop")||"no"===e.shop)||(!(!t.includes("boundary")||"no"===e.boundary)||(!(!t.includes("tourism")||"no"===e.tourism)||(!(!t.includes("historic")||"no"===e.historic)||(!(!t.includes("public_transport")||"no"===e.public_transport)||(!(!t.includes("office")||"no"===e.office)||(!(!t.includes("building:part")||"no"===e["building:part"])||(!(!t.includes("military")||"no"===e.military)||(!(!t.includes("ruins")||"no"===e.ruins)||(!(!t.includes("craft")||"no"===e.craft)||(!(!t.includes("golf")||"no"===e.golf)||(!(!t.includes("indoor")||"no"===e.indoor)||(!(!t.includes("highway")||!["services","rest_area","escape","elevator"].includes(e.highway))||(!(!t.includes("waterway")||!["riverbank","dock","boatyard","dam"].includes(e.waterway))||(!(!t.includes("barrier")||!["city_wall","ditch","hedge","retaining_wall","wall","spikes"].includes(e.barrier))||(!(!t.includes("railway")||!["station","turntable","roundhouse","platform"].includes(e.railway))||(!(!t.includes("power")||!["plant","substation","generator","transformer"].includes(e.power))||(!(!t.includes("natural")||["coastline","cliff","ridge","arete","tree_row"].includes(e.natural))||(!(!t.includes("man_made")||["cutline","embankment","pipeline"].includes(e.man_made))||!(!t.includes("aeroway")||["taxiway"].includes(e.aeroway))))))))))))))))))))))))))}function oi(e,t){if(!t)return!0;if(!e)return!1;for(var r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];if(t.includes(o))return!0}return!1}function ii(e,t){var r=e.properties.tags,n=Object.keys(t);for(var o in r)if(n.includes(o)){if(("way"==e.properties.type||"relation"==e.properties.type)&&t[o].exclude_way_values&&t[o].exclude_way_values.includes(r[o]))continue;return{k:o,v:r[o]}}return null}function ai(e,t){var r,n=function(e,t){var r=t[e.k].values.find((function(t){return t.key===e.v}));return r||null}(e.properties.primaryTag,t);return r="node"===e.properties.type?"circle":"LineString"===e.properties.way_geometry.type||"MultiLineString"===e.properties.way_geometry.type?"penta":"Polygon"===e.properties.way_geometry.type||"MultiPolygon"===e.properties.way_geometry.type?"square":"star",n?(e.properties.icon=n.icon?n.icon:"",e.properties.marker="".concat(r,"-").concat(n.markerColor,"-").concat(e.properties.icon),e.properties.hexColor=n.markerColor):(e.properties.icon="maki-circle-15",e.properties.hexColor="#000000",e.properties.marker="".concat(r,"-#000000-")),e}function si(e){e.properties.tags.name&&(e.properties._name=e.properties.tags.name),e.properties.meta.timestamp&&(e.properties.time=new Date(e.properties.meta.timestamp).getTime()),e.properties.tags.fixme&&(e.properties.fixme=!0)}function ui(e,t,r,n){var o=e.features,i=t.features;if(!o||0==o.length)return t;for(var a=[],s=0;s<o.length;s++)Re(o[s],r)&&a.push(o[s].id);for(var u=0;u<i.length;u++)for(var l=i[u].id,c=0;c<o.length;c++){if(l==o[c].id){o[c]=i[u],a.splice(a.indexOf(l),1);break}c==o.length-1&&o.push(i[u])}for(var f=0;f<a.length;f++)for(var h=a[f],d=0;d<o.length;d++)if(o[d].id==h){o.splice(d,1);break}return function(e,t){if(!t)return e;for(var r=[],n=0;n<t.features.length;n++)r.push(t.features[n].id);for(var o=e.features.length-1;o>=0;o--)r.includes(e.features[o].id)&&e.features.splice(o,1);return Eo(e)}(e,n)}function li(e){return e.replace(/&amp;/g,"&").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}return function(t,r){var n=null;r&&r.tagConfig&&(n=Object.keys(r.tagConfig));var o=ae.parse(t,{attributeNamePrefix:"",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!1,ignoreNameSpace:!1,allowBooleanAttributes:!0,parseNodeValue:!1,parseAttributeValue:!1,trimValues:!1,cdataTagName:!1,cdataPositionChar:"\\c",attrValueProcessor:function(e){return li(e)},tagValueProcessor:function(e){return li(e)}}).osm,i={minlat:Number(o.bounds.minlat),minlon:Number(o.bounds.minlon),maxlat:Number(o.bounds.maxlat),maxlon:Number(o.bounds.maxlon)},a=[i.minlon,i.minlat,i.maxlon,i.maxlat],s=function(e){Array.isArray(e)||(e=[e]);for(var t={},r=0;r<e.length;r++)t[e[r].k]=e[r].v;return t},u=function(e,t){for(var r=e[0]==e[e.length-1]?"Polygon":"LineString",n=[],o=0;o<e.length;o++){var i="node/".concat(e[o]);t[i]?n.push(t[i].geometry.coordinates):console.log("TAINDED!")}return"LineString"==r?{type:"LineString",coordinates:n}:"Polygon"==r?{type:"Polygon",coordinates:[n]}:void 0},l=function(e,t,r){var n=Eo(e),o=Array.isArray(n.member)?n.member:[n.member];n.tainted=!1;for(var i=0;i<o.length;i++){var a=o[i],s="way/".concat(a.ref);if(t[s]){var u=t[s].geometry,l=void 0;"LineString"===u.type?(a.typeGeom="LineString",l=Eo(u.coordinates)):"Polygon"===u.type&&(a.typeGeom="Polygon",l=Eo(u.coordinates[0])),a.ring=l}else a.ring=null,n.tainted=!0}if(n.tainted)return null;Array.isArray(o)||(o=[o]);var f=o.filter((function(e){return"outer"===e.role&&"Polygon"===e.typeGeom&&e.ring})),h=o.filter((function(e){return"inner"===e.role&&"Polygon"===e.typeGeom&&e.ring})),d=o.filter((function(e){return"outer"===e.role&&"LineString"===e.typeGeom&&e.ring})),g=o.filter((function(e){return"inner"===e.role&&"LineString"===e.typeGeom&&e.ring}));if(0===f.length&&0===d.length)return null;if(d.length>0){var p=c(d.map((function(e){return e.ring}))),y=!0,m=!1,v=void 0;try{for(var b,w=p[Symbol.iterator]();!(y=(b=w.next()).done);y=!0){var E=b.value;f.push({type:"way",ref:"",role:"outer",typeGeom:"Polygon",ring:E})}}catch(e){m=!0,v=e}finally{try{y||null==w.return||w.return()}finally{if(m)throw v}}}if(g.length>0){var j=c(g.map((function(e){return e.ring}))),P=!0,A=!1,x=void 0;try{for(var _,O=j[Symbol.iterator]();!(P=(_=O.next()).done);P=!0){var S=_.value;h.push({type:"way",ref:"",role:"inner",typeGeom:"Polygon",ring:S})}}catch(e){A=!0,x=e}finally{try{P||null==O.return||O.return()}finally{if(A)throw x}}}if(1==f.length){var N=[f[0].ring],T=!0,M=!1,k=void 0;try{for(var C,R=h[Symbol.iterator]();!(T=(C=R.next()).done);T=!0){var I=C.value;N.push(I.ring)}}catch(e){M=!0,k=e}finally{try{T||null==R.return||R.return()}finally{if(M)throw k}}return{type:"Polygon",coordinates:N}}var L=f.map((function(e){return[e.ring]})),F=!0,D=!1,B=void 0;try{for(var V,q=h[Symbol.iterator]();!(F=(V=q.next()).done);F=!0)for(var G=V.value,z=0;z<L.length;z++){var U=L[z][0],J=G.ring[0];ti(J,U)&&L[z].push(G.ring)}}catch(e){D=!0,B=e}finally{try{F||null==q.return||q.return()}finally{if(D)throw B}}return{type:"MultiPolygon",coordinates:L}},c=function(t){var r=[],n=t[0].slice();t.splice(0,1);for(var o=n[0].toString(),i=n[n.length-1].toString(),a=0;0!=t.length&&a<t.length;)t[a][0].toString()==i?(t[a].splice(0,1),n=[].concat(e(n),e(t[a])),t.splice(a,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0):t[a][t[a].length-1].toString()==o?(t[a].splice(t[a].length-1,1),n=[].concat(e(t[a]),e(n)),t.splice(a,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0):t[a][0].toString()==o?(t[a].splice(0,1),n=[].concat(e(t[a].reverse()),e(n)),t.splice(a,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0):t[a][t[a].length-1].toString()==i?(t[a].splice(t[a].length-1,1),n=[].concat(e(n),e(t[a].reverse())),t.splice(a,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0):a++,o==i&&(r.push(n),t.length>0&&(n=t[0].slice(),t.splice(0,1),o=n[0].toString(),i=n[n.length-1].toString(),a=0));return r},f={};Array.isArray(o.node)||(o.node=o.node?[o.node]:[]);var h=!0,d=!1,g=void 0;try{for(var p,y=o.node[Symbol.iterator]();!(h=(p=y.next()).done);h=!0){var m=p.value,v="node/".concat(m.id),b={type:"Feature",id:"node/".concat(m.id),properties:{type:"node",id:m.id,meta:{timestamp:m.timestamp,version:m.version,changeset:m.changeset,user:m.user,uid:m.uid}},geometry:{type:"Point",coordinates:[Number(m.lon),Number(m.lat)]}};m.tag&&(b.properties.tags=s(m.tag)),f[v]=b}}catch(e){d=!0,g=e}finally{try{h||null==y.return||y.return()}finally{if(d)throw g}}Array.isArray(o.way)||(o.way=o.way?[o.way]:[]);var w={},E=!0,j=!1,P=void 0;try{for(var A,x=o.way[Symbol.iterator]();!(E=(A=x.next()).done);E=!0){var _=A.value,O="way/".concat(_.id),S={type:"Feature",id:"way/".concat(_.id),properties:{type:"way",id:_.id,meta:{timestamp:_.timestamp,version:_.version,changeset:_.changeset,user:_.user,uid:_.uid}}};if(_.tag&&(S.properties.tags=s(_.tag)),_.nd){var N=[],T=!0,M=!1,k=void 0;try{for(var C,R=_.nd[Symbol.iterator]();!(T=(C=R.next()).done);T=!0){var I=C.value.ref;N.push(I);var L=f["node/".concat(I)];L&&(L.properties.usedByWays||(L.properties.usedByWays=[]),L.properties.usedByWays.push("way/".concat(_.id)))}}catch(e){M=!0,k=e}finally{try{T||null==R.return||R.return()}finally{if(M)throw k}}S.ndRefs=N,S.geometry=u(N,f)}w[O]=S}}catch(e){j=!0,P=e}finally{try{E||null==x.return||x.return()}finally{if(j)throw P}}var F={};Array.isArray(o.relation)||(o.relation=o.relation?[o.relation]:[]);var D=!0,B=!1,V=void 0;try{for(var q,G=o.relation[Symbol.iterator]();!(D=(q=G.next()).done);D=!0){var z=q.value,U="".concat(z.id),J={type:"Feature",id:"".concat(z.id),properties:{type:"relation",id:z.id,meta:{timestamp:z.timestamp,version:z.version,changeset:z.changeset,user:z.user,uid:z.uid}},member:z.member,tainted:!1};z.tag&&(J.properties.tags=s(z.tag)),Array.isArray(z.member)||(z.member=[z.member]);var $=!0,W=!1,X=void 0;try{for(var Y,Z=z.member[Symbol.iterator]();!($=(Y=Z.next()).done);$=!0){var H=Y.value,K="".concat(H.type,"/").concat(H.ref),Q="node"==H.type?f:w;Q[K]?(Q[K].properties.relations||(Q[K].properties.relations=[]),Q[K].properties.relations.push({rel:J.id,reltags:J.properties.tags,role:H.role})):J.tainted=!0}}catch(e){W=!0,X=e}finally{try{$||null==Z.return||Z.return()}finally{if(W)throw X}}F[U]=J}}catch(e){B=!0,V=e}finally{try{D||null==G.return||G.return()}finally{if(B)throw V}}for(var ee in F){var te=F[ee];if("multipolygon"===te.properties.tags.type){var re=l(te,w);re&&(te.geometry=re)}}var ne=[];for(var oe in f){var ie=f[oe].properties.tags;if(f[oe].geometry&&f[oe].properties.tags&&oi(ie,n))if(si(f[oe]),r&&r.tagConfig){var se=ii(f[oe],r.tagConfig);se&&(f[oe].properties.primaryTag=se,ai(f[oe],r.tagConfig),ne.push(f[oe]))}else ne.push(f[oe])}for(var ue in w){var le=w[ue].properties.tags;if(w[ue].geometry&&w[ue].properties.tags&&oi(le,n))if(si(w[ue]),"Polygon"!=w[ue].geometry.type&&"MultiPolygon"!=w[ue].geometry.type||ni(w[ue].properties.tags)||(w[ue].geometry.coordinates=w[ue].geometry.coordinates[0],w[ue].geometry.type="Polygon"==w[ue].geometry.type?"LineString":"MultiLineString"),ri(w[ue]),r&&r.tagConfig){var ce=ii(w[ue],r.tagConfig);ce&&(w[ue].properties.primaryTag=ce,ai(w[ue],r.tagConfig),ne.push(w[ue]))}else ne.push(w[ue])}for(var fe in F){var he=F[fe].properties.tags;if(F[fe].geometry&&F[fe].properties.tags&&oi(he,n))if(si(F[fe]),"Polygon"!=F[fe].geometry.type&&"MultiPolygon"!=F[fe].geometry.type||ni(F[fe].properties.tags)||(F[fe].geometry.coordinates=F[fe].geometry.coordinates[0],F[fe].geometry.type="Polygon"==F[fe].geometry.type?"LineString":"MultiLineString"),ri(F[fe]),r&&r.tagConfig){var de=ii(F[fe],r.tagConfig);de&&(F[fe].properties.primaryTag=de,ai(F[fe],r.tagConfig),ne.push(F[fe]))}else ne.push(F[fe])}var ge,pe,ye={type:"FeatureCollection",features:ne};if(r&&r.oldGeojson&&r.geojsonChanged){var me=Le(a);return{geojson:ui(r.oldGeojson,ye,me,r.geojsonChanged),geojsonBbox:(ge=me,(pe=r.oldBboxFeature)&&0!==pe.length?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"MultiPolygon",coordinates:ei(pe.geometry.coordinates,ge.geometry.coordinates,1)}}]}:{type:"FeatureCollection",features:[ge]})}}return{geojson:ye,geojsonBbox:null}}}();
